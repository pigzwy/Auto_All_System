<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Auto All System - 控制台</title>
    <link rel="stylesheet" href="/static/css/style.css?v=4.7" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app">
      <!-- 侧边栏 -->
      <aside class="sidebar" id="sidebar">
        <div class="logo">
          <span class="logo-icon">⚡</span>
          <span class="logo-text">AutoSystem</span>
          <button class="sidebar-toggle" id="sidebar-toggle" onclick="toggleSidebar()" title="收起侧边栏">
            <svg class="toggle-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
          </button>
        </div>

        <nav class="nav">
          <div class="nav-section">
            <div class="nav-title">概览</div>
            <a href="#" class="nav-item active" data-page="dashboard">
              <span class="nav-icon">📊</span>
              <span>仪表盘</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-title">业务管理</div>
            <a href="#" class="nav-item" data-page="accounts">
              <span class="nav-icon">👤</span>
              <span>账号管理</span>
              <span class="nav-badge" id="accounts-count">0</span>
            </a>
            <a href="#" class="nav-item" data-page="proxies">
              <span class="nav-icon">🌐</span>
              <span>代理管理</span>
              <span class="nav-badge" id="proxies-count">0</span>
            </a>
            <a href="#" class="nav-item" data-page="cards">
              <span class="nav-icon">💳</span>
              <span>卡片管理</span>
              <span class="nav-badge" id="cards-count">0</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-title">Google 专区</div>
            <a href="#" class="nav-item" data-page="sheerlink">
              <span class="nav-icon">🔗</span>
              <span>获取 G-SheerLink</span>
            </a>
            <a href="#" class="nav-item" data-page="verification">
              <span class="nav-icon">🔐</span>
              <span>批量验证 SheerID</span>
              <span class="nav-badge verification-badge" id="verification-count">0</span>
            </a>
            <a href="#" class="nav-item" data-page="bind-card">
              <span class="nav-icon">💳</span>
              <span>一键绑卡订阅</span>
            </a>
            <a href="#" class="nav-item" data-page="auto-process">
              <span class="nav-icon">🚀</span>
              <span>一键全自动处理</span>
            </a>
            <a href="#" class="nav-item" data-page="change-2fa">
              <span class="nav-icon">🔑</span>
              <span>批量更改2FA</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-title">系统</div>
            <a href="#" class="nav-item" data-page="logs">
              <span class="nav-icon">📝</span>
              <span>操作日志</span>
            </a>
            <a href="#" class="nav-item" data-page="settings">
              <span class="nav-icon">⚙️</span>
              <span>系统设置</span>
            </a>
          </div>
        </nav>

        <div class="sidebar-footer">
          <div class="version">v2.0.0</div>
        </div>
      </aside>

      <!-- 主内容区 -->
      <main class="main">
        <!-- 顶部栏 -->
        <header class="header">
          <div class="header-left">
            <button class="sidebar-expand-btn" id="sidebar-expand-btn" onclick="toggleSidebar()" title="展开侧边栏">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
            <h1 class="page-title" id="page-title">仪表盘</h1>
          </div>
          <div class="header-right">
            <button class="btn btn-ghost" id="toggle-secrets-btn" onclick="toggleSecrets()">
              <span class="btn-icon" id="toggle-secrets-icon">👁️</span>
              <span id="toggle-secrets-text">隐藏密码</span>
            </button>
            <button class="btn btn-ghost" onclick="refreshData()">
              <span class="btn-icon">🔄</span>
              刷新数据
            </button>
            <div class="status-indicator online">
              <span class="status-dot"></span>
              <span>在线</span>
            </div>
          </div>
        </header>

        <!-- 内容区 -->
        <div class="content" id="content">
          <!-- Dashboard Page -->
          <div class="page active" id="page-dashboard">
            <!-- 统计卡片 -->
            <div class="stats-grid">
              <div class="stat-card gradient-blue">
                <div class="stat-icon">👤</div>
                <div class="stat-info">
                  <div class="stat-value" id="stat-accounts">0</div>
                  <div class="stat-label">总账号数</div>
                </div>
              </div>
              <div class="stat-card gradient-green">
                <div class="stat-icon">✅</div>
                <div class="stat-info">
                  <div class="stat-value" id="stat-verified">0</div>
                  <div class="stat-label">已验证</div>
                </div>
              </div>
              <div class="stat-card gradient-purple">
                <div class="stat-icon">🌐</div>
                <div class="stat-info">
                  <div class="stat-value" id="stat-proxies">0</div>
                  <div class="stat-label">可用代理</div>
                </div>
              </div>
              <div class="stat-card gradient-orange">
                <div class="stat-icon">💳</div>
                <div class="stat-info">
                  <div class="stat-value" id="stat-cards">0</div>
                  <div class="stat-label">可用卡片</div>
                </div>
              </div>
            </div>

            <!-- 状态分布 -->
            <div class="panel">
              <div class="panel-header">
                <h2 class="panel-title">账号状态分布</h2>
              </div>
              <div class="panel-body">
                <div class="status-bars" id="status-bars">
                  <!-- 动态生成 -->
                </div>
              </div>
            </div>

            <!-- 快速操作 -->
            <div class="panel">
              <div class="panel-header">
                <h2 class="panel-title">快速操作</h2>
              </div>
              <div class="panel-body">
                <div class="quick-actions">
                  <button
                    class="action-card"
                    onclick="showModal('import-accounts')"
                  >
                    <span class="action-icon">📥</span>
                    <span class="action-text">导入账号</span>
                  </button>
                  <button
                    class="action-card"
                    onclick="showModal('import-proxies')"
                  >
                    <span class="action-icon">🌐</span>
                    <span class="action-text">导入代理</span>
                  </button>
                  <button
                    class="action-card"
                    onclick="showModal('import-cards')"
                  >
                    <span class="action-icon">💳</span>
                    <span class="action-text">导入卡片</span>
                  </button>
                  <button class="action-card" onclick="syncBrowsers()">
                    <span class="action-icon">🔗</span>
                    <span class="action-text">同步浏览器</span>
                  </button>
                  <button class="action-card" onclick="exportFiles()">
                    <span class="action-icon">📤</span>
                    <span class="action-text">导出文件</span>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Accounts Page -->
          <div class="page" id="page-accounts">
            <div class="page-toolbar">
              <div class="toolbar-left">
                <div class="filter-group">
                  <select
                    class="select"
                    id="filter-status"
                    onchange="filterAccounts()"
                  >
                    <option value="">全部状态</option>
                    <option value="pending_check">待检查</option>
                    <option value="link_ready">链接就绪</option>
                    <option value="verified">已验证</option>
                    <option value="subscribed">已订阅</option>
                    <option value="ineligible">无资格</option>
                    <option value="error">错误</option>
                  </select>
                  <input
                    type="text"
                    class="input search-input"
                    id="search-accounts"
                    placeholder="搜索邮箱..."
                    oninput="searchAccounts()"
                  />
                </div>
              </div>
              <div class="toolbar-right">
                <button
                  class="btn btn-primary"
                  onclick="showModal('import-accounts')"
                >
                  <span class="btn-icon">📥</span>
                  导入账号
                </button>
                <button class="btn btn-secondary" onclick="showModal('export-accounts')">
                  <span class="btn-icon">📤</span>
                  导出
                </button>
                <button class="btn btn-secondary" onclick="openBatchStatusModal()">
                  <span class="btn-icon">🔄</span>
                  修改状态
                </button>
                <button
                  class="btn btn-danger"
                  onclick="deleteSelectedAccounts()"
                >
                  <span class="btn-icon">🗑️</span>
                  删除选中
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>
                      <input
                        type="checkbox"
                        id="select-all-accounts"
                        onchange="toggleSelectAll('accounts')"
                      />
                    </th>
                    <th>邮箱</th>
                    <th>密码</th>
                    <th>辅助邮箱</th>
                    <th>2FA密钥</th>
                    <th>状态</th>
                    <th>已导出</th>
                    <th>更新时间</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody id="accounts-table-body">
                  <!-- 动态生成 -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Proxies Page -->
          <div class="page" id="page-proxies">
            <div class="page-toolbar">
              <div class="toolbar-left">
                <input
                  type="text"
                  class="input search-input"
                  id="search-proxies"
                  placeholder="搜索代理..."
                  oninput="searchProxies()"
                />
              </div>
              <div class="toolbar-right">
                <button
                  class="btn btn-primary"
                  onclick="showModal('import-proxies')"
                >
                  <span class="btn-icon">📥</span>
                  导入代理
                </button>
                <button class="btn btn-danger" onclick="clearProxies()">
                  <span class="btn-icon">🗑️</span>
                  清空全部
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>
                      <input
                        type="checkbox"
                        id="select-all-proxies"
                        onchange="toggleSelectAll('proxies')"
                      />
                    </th>
                    <th>类型</th>
                    <th>地址</th>
                    <th>端口</th>
                    <th>用户名</th>
                    <th>状态</th>
                    <th>使用者</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody id="proxies-table-body">
                  <!-- 动态生成 -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Cards Page -->
          <div class="page" id="page-cards">
            <div class="page-toolbar">
              <div class="toolbar-left">
                <input
                  type="text"
                  class="input search-input"
                  id="search-cards"
                  placeholder="搜索卡号..."
                  oninput="searchCards()"
                />
              </div>
              <div class="toolbar-right">
                <button
                  class="btn btn-primary"
                  onclick="showModal('import-cards')"
                >
                  <span class="btn-icon">📥</span>
                  导入卡片
                </button>
                <button class="btn btn-danger" onclick="clearCards()">
                  <span class="btn-icon">🗑️</span>
                  清空全部
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>
                      <input
                        type="checkbox"
                        id="select-all-cards"
                        onchange="toggleSelectAll('cards')"
                      />
                    </th>
                    <th>卡号</th>
                    <th>有效期</th>
                    <th>CVV</th>
                    <th>持卡人</th>
                    <th>邮编</th>
                    <th>使用次数</th>
                    <th>状态</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody id="cards-table-body">
                  <!-- 动态生成 -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Logs Page -->
          <div class="page" id="page-logs">
            <div class="panel">
              <div class="panel-header">
                <h2 class="panel-title">最近操作日志</h2>
                <button class="btn btn-ghost btn-sm" onclick="loadLogs()">
                  刷新
                </button>
              </div>
              <div class="panel-body">
                <div class="logs-list" id="logs-list">
                  <!-- 动态生成 -->
                </div>
              </div>
            </div>
          </div>

          <!-- Settings Page -->
          <div class="page" id="page-settings">
            <div class="settings-grid">
              <!-- 比特浏览器配置 -->
              <div class="panel">
                <div class="panel-header">
                  <h2 class="panel-title">🌐 比特浏览器配置</h2>
                </div>
                <div class="panel-body">
                  <div class="form-group">
                    <label class="label">API 端口</label>
                    <div class="input-group">
                      <span class="input-prefix">http://127.0.0.1:</span>
                      <input
                        type="number"
                        class="input"
                        id="setting-bit_browser_port"
                        placeholder="54345"
                        min="1024"
                        max="65535"
                        style="width: 120px;"
                      />
                    </div>
                    <small class="form-hint">比特浏览器 Local API 端口，默认 54345</small>
                  </div>
                </div>
              </div>

              <!-- SheerID 配置 -->
              <div class="panel">
                <div class="panel-header">
                  <h2 class="panel-title">🔐 SheerID 配置</h2>
                </div>
                <div class="panel-body">
                  <div class="form-group">
                    <label class="label">API Key</label>
                    <input
                      type="password"
                      class="input"
                      id="setting-sheerid_api_key"
                      placeholder="输入SheerID API Key"
                    />
                  </div>
                  <!-- API 状态显示 -->
                  <div class="quota-info" id="quota-info">
                    <div class="quota-header">
                      <span class="quota-title">API 状态</span>
                      <button class="btn btn-ghost btn-sm" onclick="refreshQuota()">
                        <span class="btn-icon">🔄</span>
                        刷新
                      </button>
                    </div>
                    <div class="quota-cards">
                      <div class="quota-card">
                        <span class="quota-value" id="quota-remaining">--</span>
                        <span class="quota-label">剩余配额</span>
                      </div>
                      <div class="quota-card">
                        <span class="quota-value" id="quota-available">--</span>
                        <span class="quota-label">可用槽位</span>
                      </div>
                      <div class="quota-card">
                        <span class="quota-value" id="quota-active">--</span>
                        <span class="quota-label">活跃任务</span>
                      </div>
                    </div>
                    <div class="quota-progress">
                      <div class="quota-progress-bar" id="quota-progress-bar" style="width: 0%"></div>
                    </div>
                    <div class="quota-status" id="quota-status">
                      <span class="status-dot"></span>
                      <span id="quota-status-text">点击刷新获取状态</span>
                    </div>
                    <div class="quota-note">
                      <small>💡 配额信息需执行一次验证后更新</small>
                    </div>
                  </div>
                </div>
              </div>

              <div class="panel full-width">
                <div class="panel-body">
                  <button class="btn btn-primary" onclick="saveSettings()">
                    <span class="btn-icon">💾</span>
                    保存设置
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- SheerLink Page -->
          <div class="page" id="page-sheerlink">
            <div class="auto-header">
              <div class="auto-stats auto-stats-detail">
                <div class="auto-stat">
                  <span class="stat-number" id="sheerlink-total">0</span>
                  <span class="stat-desc">总数</span>
                </div>
                <div class="auto-stat">
                  <span class="stat-number" id="sheerlink-processed">0</span>
                  <span class="stat-desc">已处理</span>
                </div>
                <div class="auto-stat link-ready">
                  <span class="stat-number" id="sheerlink-link-ready">0</span>
                  <span class="stat-desc">🔗待验证</span>
                </div>
                <div class="auto-stat verified">
                  <span class="stat-number" id="sheerlink-verified">0</span>
                  <span class="stat-desc">✅已验证</span>
                </div>
                <div class="auto-stat subscribed">
                  <span class="stat-number" id="sheerlink-subscribed">0</span>
                  <span class="stat-desc">💳已绑卡</span>
                </div>
                <div class="auto-stat danger">
                  <span class="stat-number" id="sheerlink-ineligible">0</span>
                  <span class="stat-desc">❌无资格</span>
                </div>
                <div class="auto-stat warning">
                  <span class="stat-number" id="sheerlink-error">0</span>
                  <span class="stat-desc">⏳错误</span>
                </div>
              </div>
              <div class="auto-actions">
                <div class="concurrency-setting">
                  <label>并发数:</label>
                  <input type="number" id="sheerlink-concurrency" value="1" min="1" max="10" class="input-sm">
                </div>
                <button class="btn btn-ghost" onclick="loadSheerLinkAccounts()">
                  <span class="btn-icon">🔄</span>
                  刷新列表
                </button>
                <button class="btn btn-success" id="btn-start-sheerlink" onclick="startSheerLinkProcess()">
                  <span class="btn-icon">🔗</span>
                  开始提取
                </button>
                <button class="btn btn-danger" id="btn-stop-sheerlink" onclick="stopSheerLinkProcess()" style="display: none;">
                  <span class="btn-icon">⏹️</span>
                  停止
                </button>
              </div>
            </div>

            <div class="auto-progress-section" id="sheerlink-progress-section" style="display: none;">
              <div class="progress-header">
                <span class="progress-title">提取进度</span>
                <span class="progress-text" id="sheerlink-progress-text">0 / 0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="sheerlink-progress-bar" style="width: 0%;"></div>
              </div>
              <div class="current-task" id="sheerlink-task-info">
                <span class="task-label">当前:</span>
                <span class="task-browser" id="sheerlink-current-account">-</span>
                <span class="task-step" id="sheerlink-current-step">-</span>
              </div>
            </div>

            <div class="auto-content">
              <div class="panel auto-panel account-panel">
                <div class="panel-header">
                  <h2 class="panel-title">账号列表</h2>
                  <div class="panel-actions">
                    <label class="checkbox-label">
                      <input type="checkbox" id="sheerlink-select-all" onchange="toggleSheerLinkSelectAll()">
                      <span>全选</span>
                    </label>
                    <span class="selected-count">已选: <span id="sheerlink-selected-count">0</span></span>
                  </div>
                </div>
                <div class="panel-body browser-list-container">
                  <div class="browser-list" id="sheerlink-list">
                    <div class="empty-state">
                      <span class="empty-icon">⏳</span>
                      <p>正在加载账号列表...</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="panel auto-panel log-panel">
                <div class="panel-header">
                  <h2 class="panel-title">执行日志</h2>
                  <button class="btn btn-ghost btn-sm" onclick="clearSheerLinkLog()">清空</button>
                </div>
                <div class="panel-body log-container">
                  <div class="auto-log" id="sheerlink-log">
                    <div class="log-empty">等待开始...</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Bind Card Page -->
          <div class="page" id="page-bind-card">
            <div class="auto-header">
              <div class="auto-stats">
                <div class="auto-stat">
                  <span class="stat-number" id="bindcard-total">0</span>
                  <span class="stat-desc">总数</span>
                </div>
                <div class="auto-stat">
                  <span class="stat-number" id="bindcard-processed">0</span>
                  <span class="stat-desc">已处理</span>
                </div>
                <div class="auto-stat success">
                  <span class="stat-number" id="bindcard-success">0</span>
                  <span class="stat-desc">成功</span>
                </div>
                <div class="auto-stat danger">
                  <span class="stat-number" id="bindcard-failed">0</span>
                  <span class="stat-desc">失败</span>
                </div>
              </div>
              <div class="auto-actions">
                <div class="concurrency-setting">
                  <label>并发数:</label>
                  <input type="number" id="bindcard-concurrency" value="1" min="1" max="10" class="input-sm">
                </div>
                <button class="btn btn-ghost" onclick="loadBindCardAccounts()">
                  <span class="btn-icon">🔄</span>
                  刷新列表
                </button>
                <button class="btn btn-success" id="btn-start-bindcard" onclick="startBindCardProcess()">
                  <span class="btn-icon">💳</span>
                  开始绑卡
                </button>
                <button class="btn btn-danger" id="btn-stop-bindcard" onclick="stopBindCardProcess()" style="display: none;">
                  <span class="btn-icon">⏹️</span>
                  停止
                </button>
              </div>
            </div>

            <div class="auto-progress-section" id="bindcard-progress-section" style="display: none;">
              <div class="progress-header">
                <span class="progress-title">绑卡进度</span>
                <span class="progress-text" id="bindcard-progress-text">0 / 0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="bindcard-progress-bar" style="width: 0%;"></div>
              </div>
              <div class="current-task" id="bindcard-task-info">
                <span class="task-label">当前:</span>
                <span class="task-browser" id="bindcard-current-account">-</span>
                <span class="task-step" id="bindcard-current-step">-</span>
              </div>
            </div>

            <div class="auto-content">
              <div class="panel auto-panel account-panel">
                <div class="panel-header">
                  <h2 class="panel-title">已验证账号 (可绑卡)</h2>
                  <div class="panel-actions">
                    <label class="checkbox-label">
                      <input type="checkbox" id="bindcard-select-all" onchange="toggleBindCardSelectAll()">
                      <span>全选</span>
                    </label>
                    <span class="selected-count">已选: <span id="bindcard-selected-count">0</span></span>
                  </div>
                </div>
                <div class="panel-body browser-list-container">
                  <div class="browser-list" id="bindcard-list">
                    <div class="empty-state">
                      <span class="empty-icon">⏳</span>
                      <p>正在加载已验证账号...</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="panel auto-panel log-panel">
                <div class="panel-header">
                  <h2 class="panel-title">执行日志</h2>
                  <button class="btn btn-ghost btn-sm" onclick="clearBindCardLog()">清空</button>
                </div>
                <div class="panel-body log-container">
                  <div class="auto-log" id="bindcard-log">
                    <div class="log-empty">等待开始...</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Auto Process Page -->
          <div class="page" id="page-auto-process">
            <!-- 任务控制面板 -->
            <div class="auto-header">
              <div class="auto-stats">
                <div class="auto-stat">
                  <span class="stat-number" id="auto-total">0</span>
                  <span class="stat-desc">总数</span>
                </div>
                <div class="auto-stat">
                  <span class="stat-number" id="auto-processed">0</span>
                  <span class="stat-desc">已处理</span>
                </div>
                <div class="auto-stat success">
                  <span class="stat-number" id="auto-success">0</span>
                  <span class="stat-desc">成功</span>
                </div>
                <div class="auto-stat danger">
                  <span class="stat-number" id="auto-failed">0</span>
                  <span class="stat-desc">失败</span>
                </div>
              </div>
              <div class="auto-actions">
                <div class="concurrency-setting">
                  <label>并发数:</label>
                  <input type="number" id="auto-concurrency" value="1" min="1" max="10" class="input-sm">
                </div>
                <button class="btn btn-ghost" onclick="loadAutoAccounts()">
                  <span class="btn-icon">🔄</span>
                  刷新列表
                </button>
                <button class="btn btn-success" id="btn-start-auto" onclick="startAutoProcess()">
                  <span class="btn-icon">🚀</span>
                  开始处理
                </button>
                <button class="btn btn-danger" id="btn-stop-auto" onclick="stopAutoProcess()" style="display: none;">
                  <span class="btn-icon">⏹️</span>
                  停止
                </button>
              </div>
            </div>

            <!-- 进度显示 -->
            <div class="auto-progress-section" id="auto-progress-section" style="display: none;">
              <div class="progress-header">
                <span class="progress-title">处理进度</span>
                <span class="progress-text" id="auto-progress-text">0 / 0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="auto-progress-bar" style="width: 0%;"></div>
              </div>
              <div class="current-task" id="current-task-info">
                <span class="task-label">当前:</span>
                <span class="task-browser" id="current-browser">-</span>
                <span class="task-step" id="current-step">-</span>
              </div>
            </div>

            <div class="auto-content">
              <!-- 账号列表 -->
              <div class="panel auto-panel account-panel">
                <div class="panel-header">
                  <h2 class="panel-title">账号列表</h2>
                  <div class="panel-actions">
                    <label class="checkbox-label">
                      <input type="checkbox" id="auto-select-all" onchange="toggleAutoSelectAll()">
                      <span>全选</span>
                    </label>
                    <span class="selected-count">已选: <span id="auto-selected-count">0</span></span>
                  </div>
                </div>
                <div class="panel-body browser-list-container">
                  <div class="browser-list" id="browser-list">
                    <div class="empty-state">
                      <span class="empty-icon">⏳</span>
                      <p>正在加载账号列表...</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 执行日志 -->
              <div class="panel auto-panel log-panel">
                <div class="panel-header">
                  <h2 class="panel-title">执行日志</h2>
                  <button class="btn btn-ghost btn-sm" onclick="clearAutoLog()">清空</button>
                </div>
                <div class="panel-body log-container">
                  <div class="auto-log" id="auto-log">
                    <div class="log-empty">等待开始...</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 处理结果 -->
            <div class="panel" id="auto-results-panel" style="display: none;">
              <div class="panel-header">
                <h2 class="panel-title">处理结果</h2>
              </div>
              <div class="panel-body">
                <div class="results-grid" id="auto-results-grid">
                  <!-- 动态填充 -->
                </div>
              </div>
            </div>
          </div>

          <!-- Change 2FA Page -->
          <div class="page" id="page-change-2fa">
            <div class="auto-header">
              <div class="auto-stats auto-stats-detail">
                <div class="auto-stat">
                  <span class="stat-number" id="change2fa-total">0</span>
                  <span class="stat-desc">总数</span>
                </div>
                <div class="auto-stat">
                  <span class="stat-number" id="change2fa-processed">0</span>
                  <span class="stat-desc">已处理</span>
                </div>
                <div class="auto-stat success">
                  <span class="stat-number" id="change2fa-success">0</span>
                  <span class="stat-desc">✅成功</span>
                </div>
                <div class="auto-stat danger">
                  <span class="stat-number" id="change2fa-failed">0</span>
                  <span class="stat-desc">❌失败</span>
                </div>
              </div>
              <div class="auto-actions">
                <div class="concurrency-setting">
                  <label>并发数:</label>
                  <input type="number" id="change2fa-concurrency" value="1" min="1" max="5" class="input-sm">
                </div>
                <button class="btn btn-ghost" onclick="loadChange2FAAccounts()">
                  <span class="btn-icon">🔄</span>
                  刷新列表
                </button>
                <button class="btn btn-success" id="btn-start-change2fa" onclick="startChange2FAProcess()">
                  <span class="btn-icon">🔑</span>
                  开始更改
                </button>
                <button class="btn btn-danger" id="btn-stop-change2fa" onclick="stopChange2FAProcess()" style="display: none;">
                  <span class="btn-icon">⏹️</span>
                  停止
                </button>
              </div>
            </div>

            <div class="auto-progress-section" id="change2fa-progress-section" style="display: none;">
              <div class="progress-header">
                <span class="progress-title">更改进度</span>
                <span class="progress-text" id="change2fa-progress-text">0 / 0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="change2fa-progress-bar" style="width: 0%;"></div>
              </div>
              <div class="current-task" id="change2fa-task-info">
                <span class="task-label">当前:</span>
                <span class="task-browser" id="change2fa-current-account">-</span>
                <span class="task-step" id="change2fa-current-step">-</span>
              </div>
            </div>

            <div class="auto-content">
              <div class="panel auto-panel account-panel">
                <div class="panel-header">
                  <h2 class="panel-title">有2FA密钥的账号</h2>
                  <div class="panel-actions">
                    <label class="checkbox-label">
                      <input type="checkbox" id="change2fa-select-all" onchange="toggleChange2FASelectAll()">
                      <span>全选</span>
                    </label>
                    <span class="selected-count">已选: <span id="change2fa-selected-count">0</span></span>
                  </div>
                </div>
                <div class="panel-body browser-list-container">
                  <div class="browser-list" id="change2fa-list">
                    <div class="empty-state">
                      <span class="empty-icon">⏳</span>
                      <p>正在加载账号...</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="panel auto-panel log-panel">
                <div class="panel-header">
                  <h2 class="panel-title">执行日志</h2>
                  <button class="btn btn-ghost btn-sm" onclick="clearChange2FALog()">清空</button>
                </div>
                <div class="panel-body log-container">
                  <div class="auto-log" id="change2fa-log">
                    <div class="log-empty">等待开始...</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Verification Page -->
          <div class="page" id="page-verification">
            <!-- 验证控制面板 -->
            <div class="verification-header">
              <div class="verification-stats">
                <div class="verification-stat">
                  <span class="stat-number" id="verify-total">0</span>
                  <span class="stat-desc">待验证</span>
                </div>
                <div class="verification-stat">
                  <span class="stat-number" id="verify-selected">0</span>
                  <span class="stat-desc">已选中</span>
                </div>
                <div class="verification-stat">
                  <span class="stat-number" id="verify-success">0</span>
                  <span class="stat-desc">成功</span>
                </div>
                <div class="verification-stat">
                  <span class="stat-number" id="verify-failed">0</span>
                  <span class="stat-desc">失败</span>
                </div>
              </div>
              <div class="verification-actions">
                <button class="btn btn-primary" id="btn-start-verify" onclick="startVerification()">
                  <span class="btn-icon">🚀</span>
                  开始验证
                </button>
                <button class="btn btn-danger" id="btn-stop-verify" onclick="stopVerification()" style="display:none;">
                  <span class="btn-icon">⏹️</span>
                  停止验证
                </button>
                <button class="btn btn-ghost" onclick="loadVerificationAccounts()">
                  <span class="btn-icon">🔄</span>
                  刷新列表
                </button>
              </div>
            </div>

            <!-- 验证进度 -->
            <div class="verification-progress" id="verification-progress" style="display:none;">
              <div class="progress-header">
                <span class="progress-title">验证进度</span>
                <span class="progress-text" id="progress-text">0 / 0</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
              </div>
              <div class="progress-status" id="progress-status">准备中...</div>
            </div>

            <!-- 待验证账号列表 -->
            <div class="panel">
              <div class="panel-header">
                <h2 class="panel-title">待验证账号列表</h2>
                <div class="panel-actions">
                  <label class="checkbox-label">
                    <input type="checkbox" id="verify-select-all" onchange="toggleVerifySelectAll()">
                    <span>全选</span>
                  </label>
                </div>
              </div>
              <div class="panel-body">
                <div class="verification-list" id="verification-list">
                  <!-- 动态生成账号列表 -->
                  <div class="empty-state" id="verification-empty">
                    <span class="empty-icon">📭</span>
                    <p>暂无待验证的账号</p>
                    <p class="empty-hint">账号状态为"待验证"时会显示在这里</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 验证日志 -->
            <div class="panel">
              <div class="panel-header">
                <h2 class="panel-title">验证日志</h2>
                <button class="btn btn-ghost btn-sm" onclick="clearVerificationLog()">
                  <span class="btn-icon">🗑️</span>
                  清空
                </button>
              </div>
              <div class="panel-body">
                <div class="verification-log" id="verification-log">
                  <div class="log-placeholder">验证日志将显示在这里...</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- 模态框 -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal()"></div>

    <!-- 导入账号模态框 -->
    <div class="modal" id="modal-import-accounts">
      <div class="modal-header">
        <h3 class="modal-title">导入账号</h3>
        <button class="modal-close" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="label">账号数据</label>
          <textarea
            class="textarea"
            id="import-accounts-text"
            rows="10"
            placeholder="每行一个账号，格式：邮箱----密码----辅助邮箱----2FA密钥"
          ></textarea>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="label">分隔符</label>
            <input
              type="text"
              class="input"
              id="import-accounts-separator"
              value="----"
            />
          </div>
          <div class="form-group">
            <label class="label">初始状态</label>
            <select class="select" id="import-accounts-status">
              <option value="pending_check">待检查</option>
              <option value="verified">已验证</option>
            </select>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" onclick="closeModal()">取消</button>
        <button class="btn btn-primary" onclick="importAccounts()">导入</button>
      </div>
    </div>

    <!-- 导入代理模态框 -->
    <div class="modal" id="modal-import-proxies">
      <div class="modal-header">
        <h3 class="modal-title">导入代理</h3>
        <button class="modal-close" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="label">代理数据</label>
          <textarea
            class="textarea"
            id="import-proxies-text"
            rows="10"
            placeholder="每行一个代理，支持格式：
socks5://user:pass@host:port
host:port:user:pass
host:port"
          ></textarea>
        </div>
        <div class="form-group">
          <label class="label">代理类型</label>
          <select class="select" id="import-proxies-type">
            <option value="socks5">SOCKS5</option>
            <option value="http">HTTP</option>
            <option value="https">HTTPS</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" onclick="closeModal()">取消</button>
        <button class="btn btn-primary" onclick="importProxies()">导入</button>
      </div>
    </div>

    <!-- 导入卡片模态框 -->
    <div class="modal" id="modal-import-cards">
      <div class="modal-header">
        <h3 class="modal-title">导入卡片</h3>
        <button class="modal-close" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="label">卡片数据</label>
          <textarea
            class="textarea"
            id="import-cards-text"
            rows="10"
            placeholder="每行一张卡，格式：卡号 月 年 CVV [持卡人] [邮编]
持卡人含字母自动识别，邮编为纯数字自动识别"
          ></textarea>
        </div>
        <div class="form-group">
          <label class="label">最大使用次数</label>
          <input
            type="number"
            class="input"
            id="import-cards-max-usage"
            value="1"
            min="1"
          />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" onclick="closeModal()">取消</button>
        <button class="btn btn-primary" onclick="importCards()">导入</button>
      </div>
    </div>

    <!-- 编辑卡片模态框 -->
    <div class="modal" id="modal-edit-card">
      <div class="modal-header">
        <h3 class="modal-title">编辑卡片</h3>
        <button class="modal-close" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="edit-card-id" />
        <div class="form-row">
          <div class="form-group" style="flex: 2;">
            <label class="label">卡号 *</label>
            <input type="text" class="input" id="edit-card-number" placeholder="卡号" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="label">有效月份 *</label>
            <input type="text" class="input" id="edit-card-exp-month" placeholder="MM" maxlength="2" />
          </div>
          <div class="form-group">
            <label class="label">有效年份 *</label>
            <input type="text" class="input" id="edit-card-exp-year" placeholder="YY" maxlength="2" />
          </div>
          <div class="form-group">
            <label class="label">CVV *</label>
            <input type="text" class="input" id="edit-card-cvv" placeholder="CVV" maxlength="4" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="label">持卡人姓名</label>
            <input type="text" class="input" id="edit-card-holder" placeholder="持卡人姓名（可选）" />
          </div>
          <div class="form-group">
            <label class="label">邮编</label>
            <input type="text" class="input" id="edit-card-zip" placeholder="邮编（可选）" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="label">已使用次数</label>
            <input type="number" class="input" id="edit-card-usage" value="0" min="0" />
          </div>
          <div class="form-group">
            <label class="label">最大使用次数</label>
            <input type="number" class="input" id="edit-card-max-usage" value="1" min="1" />
          </div>
        </div>
        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" id="edit-card-active" checked />
            <span>卡片可用</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" onclick="closeModal()">取消</button>
        <button class="btn btn-primary" onclick="saveCardEdit()">保存</button>
      </div>
    </div>

    <!-- 导出账号模态框 -->
    <div class="modal" id="modal-export-accounts">
      <div class="modal-header">
        <h3 class="modal-title">导出账号</h3>
        <button class="modal-close" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="label">筛选状态</label>
          <select class="select" id="export-accounts-status">
            <option value="">全部状态</option>
            <option value="pending_check">待检查</option>
            <option value="link_ready">链接就绪</option>
            <option value="verified">已验证</option>
            <option value="subscribed">已订阅（含解锁Antigravity）</option>
            <option value="subscribed_antigravity">仅已解锁Antigravity</option>
            <option value="ineligible">无资格</option>
            <option value="error">错误</option>
          </select>
        </div>
        <div class="form-group">
          <label class="label">导出选项</label>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="export-include-exported" checked> 包括已导出的账号
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="export-mark-exported" checked> 导出后标记为已导出
            </label>
          </div>
        </div>
        <div class="form-group">
          <label class="label">导出字段（可多选）</label>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="export-field-email" checked disabled> 邮箱
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="export-field-password" checked> 密码
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="export-field-recovery"> 辅助邮箱
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="export-field-secret"> 2FA密钥
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="export-field-link"> 验证链接
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="export-field-status"> 状态
            </label>
          </div>
        </div>
        <div class="form-group">
          <label class="label">分隔符</label>
          <input type="text" class="input" id="export-accounts-separator" value="----">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" onclick="closeModal()">取消</button>
        <button class="btn btn-primary" onclick="exportAccounts()">导出</button>
      </div>
    </div>

    <!-- 批量修改状态模态框 -->
    <div class="modal" id="modal-batch-status">
      <div class="modal-header">
        <h3 class="modal-title">批量修改状态</h3>
        <button class="modal-close" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <p style="margin-bottom: 16px; color: var(--text-muted);">
            已选中 <strong id="batch-status-count">0</strong> 个账号
          </p>
        </div>
        <div class="form-group">
          <label class="label">修改为</label>
          <select class="select" id="batch-status-select">
            <option value="">请选择状态...</option>
            <option value="pending_check">待检查 (pending_check)</option>
            <option value="link_ready">链接就绪 (link_ready)</option>
            <option value="verified">已验证 (verified)</option>
            <option value="subscribed">已订阅 (subscribed)</option>
            <option value="subscribed_antigravity">已解锁 (subscribed_antigravity)</option>
            <option value="ineligible">无资格 (ineligible)</option>
            <option value="error">错误 (error)</option>
          </select>
        </div>
        <div class="info-box" style="margin-top: 16px; padding: 12px; background: var(--bg-tertiary); border-radius: 8px; font-size: 13px;">
          <p style="margin: 0 0 8px; color: var(--warning-color);">💡 提示：</p>
          <ul style="margin: 0; padding-left: 20px; color: var(--text-muted);">
            <li>只有 <strong>待检查</strong> 状态的账号才会被创建窗口</li>
            <li>已处理的账号可以修改为其他状态避免重复处理</li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" onclick="closeModal()">取消</button>
        <button class="btn btn-primary" onclick="batchUpdateStatus()">确认修改</button>
      </div>
    </div>

    <!-- Toast 通知 -->
    <div class="toast-container" id="toast-container"></div>

    <script src="/static/js/app.js?v=4.7"></script>
  </body>
</html>
