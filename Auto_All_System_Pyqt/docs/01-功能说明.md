# 功能说明文档

本文档详细介绍比特浏览器自动化管理工具的所有功能。

---

## 📑 目录

1. [比特浏览器窗口管理](#1-比特浏览器窗口管理)
2. [SheerID 验证功能](#2-sheerid-验证功能)
3. [绑卡订阅功能](#3-绑卡订阅功能)
4. [一键全自动处理](#4-一键全自动处理)
5. [账号管理功能](#5-账号管理功能)
6. [数据库管理](#6-数据库管理)

---

## 1. 比特浏览器窗口管理

### 1.1 功能概述

管理比特浏览器窗口，包括创建、查看、删除和打开浏览器窗口。

### 1.2 批量创建窗口

#### 使用步骤

1. **准备数据文件**
   - `data/accounts.txt` - 账号信息
   - `data/proxies.txt` - 代理信息

2. **配置参数**（可选）
   - **模板窗口ID**: 使用现有窗口作为模板
   - **自定义平台URL**: 设置首页URL
   - **额外URL**: 添加书签或快捷访问

3. **执行创建**
   - 点击"批量创建窗口"按钮
   - 系统自动为每个账号创建窗口
   - 自动配置代理和账号信息

#### 窗口命名规则

```
格式: Google_序号_邮箱前缀
示例: Google_001_user123
```

#### 自动配置内容

- ✅ 窗口名称
- ✅ 代理服务器
- ✅ 浏览器指纹
- ✅ User-Agent
- ✅ 备注信息（包含完整邮箱）

### 1.3 查看窗口列表

#### 显示内容

| 列名 | 说明 |
|------|------|
| ID | 窗口唯一标识符 |
| 名称 | 窗口名称 |
| 备注 | 关联的账号信息 |
| 分组 | 所属分组 |
| 代理 | 代理服务器信息 |

#### 操作功能

- **刷新列表** - 更新窗口列表
- **搜索过滤** - 按名称或备注搜索
- **排序** - 按任意列排序
- **批量选择** - 使用复选框批量选择

### 1.4 打开浏览器

**功能**：在比特浏览器中打开指定窗口

**步骤**：
1. 在窗口列表中选择一个或多个窗口
2. 点击"打开浏览器"按钮
3. 比特浏览器会自动打开选中的窗口

**应用场景**：
- 手动登录账号
- 检查窗口配置
- 执行人工操作

### 1.5 删除窗口

#### 删除单个窗口

1. 在列表中选择窗口
2. 点击"删除选中窗口"
3. 确认删除

#### 批量删除窗口

**按名称模糊匹配删除**：
1. 输入名称关键词（如：`Google_`）
2. 点击"批量删除（按名称）"
3. 系统会删除所有包含该关键词的窗口

**注意**：删除操作不可恢复，请谨慎操作！

---

## 2. SheerID 验证功能

### 2.1 功能概述

批量提交 SheerID 学生验证，并自动轮询验证状态。

### 2.2 准备工作

#### 2.2.1 获取 SheerID API Key

联系服务提供商获取 API Key。

API 端点：`https://batch.1key.me`

#### 2.2.2 准备链接文件

**文件**：`data/sheerIDlink.txt`

**格式**：`email----sheerid_verification_url`

**示例**：
```
user1@gmail.com----https://services.sheerid.com/verify/xxx
user2@gmail.com----https://services.sheerid.com/verify/yyy
```

### 2.3 使用步骤

1. **打开 SheerID 验证窗口**
   - 在主界面点击"SheerID验证"按钮
   - 或切换到"SheerID验证"选项卡

2. **配置参数**
   - **API Key**: 输入你的 SheerID API Key
   - **线程数**: 建议 1（API 有速率限制）

3. **导入链接**
   - 点击"从文件导入"
   - 选择 `sheerIDlink.txt`
   - 或手动粘贴链接到文本框

4. **开始验证**
   - 点击"开始批量验证"
   - 系统会批量提交验证（每批最多 5 个）

5. **查看进度**
   - 表格中显示每个验证的状态
   - 日志区显示详细进度

### 2.4 验证状态

| 状态 | 说明 |
|------|------|
| ⏳ pending | 等待提交 |
| 🔄 submitted | 已提交，等待审核 |
| ✅ verified | 验证成功 |
| ❌ failed | 验证失败 |
| ⏱️ timeout | 超时 |

### 2.5 处理结果

验证成功的账号会被标记为 `verified` 状态，并保存到数据库。

---

## 3. 绑卡订阅功能

### 3.1 功能概述

为已验证的 Google 账号自动绑定信用卡并订阅 Google One 学生优惠。

### 3.2 前置条件

- ✅ 账号已通过 SheerID 验证（状态为 `verified`）
- ✅ 已准备好信用卡信息（`data/cards.txt`）
- ✅ 比特浏览器窗口已创建

### 3.3 准备卡片文件

**文件**：`data/cards.txt`

**格式**：`card_number|exp_month|exp_year|cvv`

**示例**：
```
4111111111111111|12|2025|123
5555555555554444|06|2026|456
3782822463100005|03|2027|789
```

**支持的卡类型**：
- Visa
- Mastercard
- American Express
- Discover

### 3.4 使用步骤

1. **打开绑卡订阅窗口**
   - 点击"绑卡订阅"按钮

2. **选择账号**
   - 勾选要处理的账号
   - 只显示状态为 `verified` 的账号

3. **配置参数**
   - **一卡几绑**: 一张卡绑定几个账号（如：3）
   - **并发线程数**: 建议 3
   - **延迟设置**:
     - 登录后等待: 5 秒
     - 绑卡后等待: 10 秒

4. **开始绑卡**
   - 点击"开始绑卡"
   - 系统会自动分配卡片并处理

### 3.5 绑卡流程

```
1. 打开比特浏览器窗口
   ↓
2. 使用 Playwright 连接浏览器
   ↓
3. 导航到 Google One 页面
   ↓
4. 检测登录状态（如未登录则登录）
   ↓
5. 点击 "Get student offer"
   ↓
6. 填写信用卡信息
   - 卡号
   - 过期日期
   - CVV
   ↓
7. 提交并确认订阅
   ↓
8. 验证订阅状态
   ↓
9. 关闭浏览器
```

### 3.6 处理结果

| 结果状态 | 保存位置 |
|---------|---------|
| ✅ 绑卡成功 | `已绑卡号.txt` |
| ⚠️ 已订阅 | 跳过（不重复处理）|
| ❌ 失败 | `超时或其他错误.txt` |

### 3.7 错误处理

**常见错误**：

1. **卡片被拒绝**
   - 检查卡片信息是否正确
   - 确认卡片有效且有余额

2. **已经订阅**
   - 系统会自动跳过
   - 不会重复绑卡

3. **页面加载超时**
   - 增加延迟时间
   - 检查网络连接

---

## 4. 一键全自动处理

### 4.1 功能概述

这是最强大的功能，整合了完整的自动化流程：

```
登录 → 检测资格 → 获取链接 → SheerID验证 → 绑卡订阅
```

### 4.2 完整流程

#### 阶段 1: 登录账号

- 打开比特浏览器窗口
- 导航到 Google 登录页面
- 输入邮箱和密码
- 处理 2FA 验证（自动生成 TOTP 验证码）
- 处理备用邮箱验证（如需要）

#### 阶段 2: 检测资格

- 访问 Google One 学生优惠页面
- 检测是否显示 "Get student offer"
- 判断账号状态：
  - ✅ **有资格** - 继续下一步
  - ⚠️ **已验证未绑卡** - 跳到绑卡步骤
  - ⚠️ **已订阅** - 跳过
  - ❌ **无资格** - 标记并跳过

#### 阶段 3: 提取 SheerID 链接

- 点击 "Get student offer"
- 等待 SheerID 验证页面加载
- 提取验证链接（`https://services.sheerid.com/verify/...`）
- 保存到数据库和 `sheerIDlink.txt`

#### 阶段 4: SheerID 验证

- 使用 SheerID API 批量提交验证
- 轮询验证状态
- 等待验证成功

#### 阶段 5: 绑卡订阅

- 刷新 Google One 页面
- 填写信用卡信息
- 提交订阅
- 验证订阅成功

### 4.3 配置参数

#### 基本参数

| 参数 | 说明 | 推荐值 |
|------|------|--------|
| SheerID API Key | API 密钥 | 必填 |
| 并发线程数 | 同时处理的账号数 | 3-5 |
| 一卡几绑 | 每张卡绑定账号数 | 3 |

#### 延迟参数

| 参数 | 说明 | 推荐值 |
|------|------|--------|
| 登录后等待 | 登录成功后等待时间 | 5 秒 |
| 获取链接后等待 | 提取链接后等待时间 | 3 秒 |
| 验证后等待 | SheerID 验证后等待时间 | 5 秒 |
| 绑卡后等待 | 绑卡成功后等待时间 | 10 秒 |

### 4.4 使用步骤

1. **准备数据文件**
   - `accounts.txt` - 账号信息
   - `proxies.txt` - 代理信息
   - `cards.txt` - 卡片信息

2. **打开一键全自动界面**
   - 切换到"一键全自动"选项卡

3. **配置参数**
   - 填写 SheerID API Key
   - 设置线程数和绑卡数量
   - 调整延迟时间

4. **选择账号**
   - 勾选要处理的账号
   - 可以全选或部分选择

5. **开始处理**
   - 点击"开始全自动处理"
   - 观察进度和日志

6. **等待完成**
   - 处理过程全自动
   - 可随时点击"停止处理"中断

### 4.5 实时监控

#### 进度显示

- 账号列表中显示每个账号的状态
- 日志区显示详细处理日志
- 状态会实时更新

#### 日志类型

| 标记 | 说明 |
|------|------|
| ℹ️ | 信息 |
| ✅ | 成功 |
| ⚠️ | 警告 |
| ❌ | 错误 |

### 4.6 处理结果

处理完成后，账号会被分类保存：

| 文件名 | 说明 |
|--------|------|
| `已绑卡号.txt` | 成功绑卡订阅 |
| `已验证未绑卡.txt` | 通过验证但未绑卡 |
| `有资格待验证号.txt` | 有资格但未验证 |
| `无资格号.txt` | 不符合资格 |
| `超时或其他错误.txt` | 处理失败 |

---

## 5. 账号管理功能

### 5.1 账号数据库

所有账号信息存储在 `data/accounts.db` SQLite 数据库中。

#### 数据表结构

```sql
CREATE TABLE accounts (
    id INTEGER PRIMARY KEY,
    email TEXT UNIQUE NOT NULL,
    password TEXT NOT NULL,
    recovery_email TEXT,
    secret TEXT,
    browser_id TEXT,
    status TEXT DEFAULT 'pending',
    sheerid_link TEXT,
    notes TEXT,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

### 5.2 账号状态

| 状态 | 说明 |
|------|------|
| pending | 待处理（初始状态）|
| processing | 处理中 |
| verified | 已验证（SheerID）|
| subscribed | 已订阅（绑卡成功）|
| failed | 失败 |
| no_eligibility | 无资格 |

### 5.3 导入导出

#### 从文本文件导入

**格式**：`email----password----recovery_email----2fa_secret`

```python
# 系统会自动：
# 1. 解析文本文件
# 2. 加密敏感信息
# 3. 插入数据库
# 4. 去重处理
```

#### 导出到文本文件

```python
# 可以导出为：
# - 完整格式（包含所有字段）
# - 简化格式（仅包含邮箱和状态）
```

### 5.4 数据加密

**加密字段**：
- password（密码）
- secret（2FA 密钥）

**加密方法**：
- 使用 Fernet 对称加密
- 密钥存储在环境变量或配置文件中

---

## 6. 数据库管理

### 6.1 数据迁移

**从文本文件迁移到数据库**：

```bash
cd src
python migrate_txt_to_db.py
```

功能：
- 读取 `accounts.txt`
- 解析账号信息
- 插入到 `accounts.db`
- 保留原文件作为备份

### 6.2 数据备份

**手动备份**：

```bash
# 备份数据库
copy data\accounts.db data\backup\accounts_20260119.db

# 备份文本文件
copy data\accounts.txt data\backup\accounts_20260119.txt
```

**定期备份建议**：
- 每天备份一次
- 保留最近 7 天的备份
- 重要数据异地备份

### 6.3 数据恢复

**从备份恢复**：

```bash
# 恢复数据库
copy data\backup\accounts_20260119.db data\accounts.db

# 或从文本文件重新导入
python migrate_txt_to_db.py
```

### 6.4 数据清理

**清理测试数据**：

```sql
-- 删除失败的账号
DELETE FROM accounts WHERE status = 'failed';

-- 删除特定邮箱
DELETE FROM accounts WHERE email LIKE '%test%';

-- 重置账号状态
UPDATE accounts SET status = 'pending' WHERE status = 'processing';
```

---

## 7. 高级功能

### 7.1 自定义延迟策略

根据网络环境调整延迟：

```python
# 网络良好
delays = {
    'after_login': 3,
    'after_get_link': 2,
    'after_verify': 3,
    'after_bind': 5
}

# 网络较慢
delays = {
    'after_login': 8,
    'after_get_link': 5,
    'after_verify': 8,
    'after_bind': 15
}
```

### 7.2 错误重试机制

系统会自动重试以下错误：
- 网络超时（重试 3 次）
- 页面加载失败（重试 2 次）
- 元素查找失败（重试 5 次）

### 7.3 并发控制

**线程数选择**：
- 1-3 个：稳定，适合新手
- 4-5 个：平衡，适合有经验用户
- 6+ 个：高效，但可能被检测

**建议**：
- 首次使用：3 个线程
- 熟悉后：可增加到 5 个
- 不建议超过 8 个

---

## 8. 最佳实践

### 8.1 工作流程建议

1. **批量创建窗口** - 一次性创建所有需要的窗口
2. **测试单个账号** - 选择 1 个账号测试完整流程
3. **小批量处理** - 先处理 5-10 个账号
4. **检查结果** - 确认无误后处理剩余账号
5. **定期备份** - 处理完一批后立即备份

### 8.2 效率优化

- ✅ 使用模板窗口快速创建
- ✅ 合理设置并发数
- ✅ 优化延迟时间
- ✅ 使用质量好的代理
- ✅ 批量处理而非逐个处理

### 8.3 风险控制

- ⚠️ 不要过度并发
- ⚠️ 设置适当延迟
- ⚠️ 使用不同代理
- ⚠️ 分散处理时间
- ⚠️ 定期检查账号状态

---

## 9. 故障排查

### 9.1 日志分析

**日志位置**：应用程序右侧日志区

**关键信息**：
- 错误类型
- 失败步骤
- 详细错误消息

### 9.2 常见问题

详见 **[常见问题.md](./常见问题.md)**

---

**最后更新**: 2026-01-19  
**版本**: 2.0.0

