# 常见问题解答（FAQ）

本文档包含使用比特浏览器自动化管理工具时的常见问题和解决方案。

---

## 📑 目录

1. [安装和配置问题](#1-安装和配置问题)
2. [比特浏览器连接问题](#2-比特浏览器连接问题)
3. [账号登录问题](#3-账号登录问题)
4. [SheerID 验证问题](#4-sheerid-验证问题)
5. [绑卡订阅问题](#5-绑卡订阅问题)
6. [性能和稳定性问题](#6-性能和稳定性问题)
7. [数据管理问题](#7-数据管理问题)
8. [其他问题](#8-其他问题)

---

## 1. 安装和配置问题

### Q1.1: 如何安装 Python 依赖？

**A**: 使用 pip 安装：

```bash
cd Auto_All_System_Pyqt
pip install -r data/requirements.txt
```

如果安装很慢，可以使用国内镜像：

```bash
pip install -r data/requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

---

### Q1.2: Playwright 浏览器安装失败？

**症状**：`playwright install chromium` 失败或下载很慢

**解决方案**：

#### 方案 A：使用镜像源

```bash
# Windows
set PLAYWRIGHT_DOWNLOAD_HOST=https://playwright.azureedge.net
playwright install chromium

# Linux/Mac
export PLAYWRIGHT_DOWNLOAD_HOST=https://playwright.azureedge.net
playwright install chromium
```

#### 方案 B：手动下载

1. 访问 Playwright GitHub Releases
2. 下载对应版本的浏览器包
3. 解压到 Playwright 缓存目录

#### 方案 C：离线安装

```bash
# 在能联网的机器上下载
playwright install chromium

# 复制浏览器目录到离线机器
# Windows: %USERPROFILE%\AppData\Local\ms-playwright
# Linux: ~/.cache/ms-playwright
```

---

### Q1.3: 提示缺少某个模块？

**症状**：`ModuleNotFoundError: No module named 'xxx'`

**解决方案**：

```bash
# 单独安装缺失的模块
pip install xxx

# 或重新安装所有依赖
pip install -r data/requirements.txt --force-reinstall
```

---

### Q1.4: PyQt6 相关错误？

**症状**：`ImportError: DLL load failed` 或 Qt 相关错误

**解决方案**：

```bash
# 卸载并重新安装 PyQt6
pip uninstall PyQt6 PyQt6-Qt6 PyQt6-sip
pip install PyQt6

# 或使用特定版本
pip install PyQt6==6.4.0
```

**Windows 特殊问题**：
- 安装 Visual C++ Redistributable
- 下载地址：https://aka.ms/vs/17/release/vc_redist.x64.exe

---

## 2. 比特浏览器连接问题

### Q2.1: 无法连接到比特浏览器 API？

**症状**：`Connection refused` 或 `无法连接`

**检查步骤**：

1. **确认比特浏览器已启动**
   ```bash
   # 在浏览器中访问
   http://127.0.0.1:54345/api/v1/browser/list
   ```
   
2. **检查 API 是否启用**
   - 打开比特浏览器设置
   - 找到"API设置"
   - 确认 HTTP API 已启用
   - 端口为 54345

3. **检查防火墙**
   - Windows 防火墙可能拦截本地连接
   - 添加端口 54345 到允许列表

4. **检查端口占用**
   ```bash
   netstat -ano | findstr 54345
   ```

---

### Q2.2: API 端口不是 54345？

**解决方案**：修改代码中的端口配置

编辑 `src/bit_api.py`：

```python
# 修改这一行
API_HOST = "http://127.0.0.1:你的端口"
```

或编辑 `src/bitbrowser_api.py`：

```python
class BitBrowserAPI:
    def __init__(self, host="http://127.0.0.1:你的端口"):
        self.host = host
```

---

### Q2.3: 获取窗口列表为空？

**可能原因**：

1. **比特浏览器中确实没有窗口**
   - 在比特浏览器中手动创建一个窗口测试

2. **API 返回格式不匹配**
   - 检查比特浏览器版本
   - 更新到最新版本

3. **权限问题**
   - 以管理员身份运行比特浏览器
   - 以管理员身份运行本程序

---

## 3. 账号登录问题

### Q3.1: 无法自动登录 Google 账号？

**常见原因和解决方案**：

#### 原因 1: 密码错误

**检查**：`data/accounts.txt` 中的密码是否正确

**格式**：`email----password----recovery_email----2fa_secret`

#### 原因 2: 2FA 验证失败

**检查**：2FA 密钥是否正确

**测试方法**：
```python
import pyotp
secret = "你的2FA密钥"
totp = pyotp.TOTP(secret)
print(totp.now())  # 生成当前验证码
```

在 Google 账号中验证这个验证码是否有效。

#### 原因 3: 需要备用邮箱验证

**解决**：确保 `accounts.txt` 中填写了正确的备用邮箱

#### 原因 4: Google 安全检查

**表现**：提示"不常用设备"或"可疑活动"

**解决方案**：
- 使用质量好的代理
- 增加登录后的等待时间
- 首次手动登录一次，通过安全检查

---

### Q3.2: 2FA 验证码不正确？

**症状**：提示"验证码无效"或"验证码错误"

**解决方案**：

1. **检查时间同步**
   ```bash
   # 确保系统时间准确
   # TOTP 依赖时间同步
   ```

2. **验证密钥格式**
   - 2FA 密钥应该是 16 位字母（无空格）
   - 示例：`JBSWY3DPEHPK3PXP`

3. **重新获取 2FA 密钥**
   - 在 Google 账号安全设置中
   - 禁用旧的 2FA
   - 重新启用并记录新密钥

---

### Q3.3: 登录后立即退出？

**可能原因**：

1. **Cookie 未保存**
   - 检查浏览器窗口配置
   - 确认启用了 Cookie

2. **会话过期**
   - 增加登录后的等待时间
   - 确保完全加载完成

3. **被识别为机器人**
   - 使用更真实的浏览器指纹
   - 添加随机延迟
   - 使用高质量代理

---

## 4. SheerID 验证问题

### Q4.1: SheerID API 返回错误？

**常见错误码**：

| 错误码 | 说明 | 解决方案 |
|--------|------|----------|
| 401 | API Key 无效 | 检查 API Key 是否正确 |
| 429 | 请求过于频繁 | 减少线程数或增加延迟 |
| 400 | 请求参数错误 | 检查链接格式 |
| 500 | 服务器错误 | 稍后重试 |

---

### Q4.2: 验证链接提取失败？

**症状**：无法从页面中提取 SheerID 链接

**检查步骤**：

1. **手动访问检查**
   - 手动登录账号
   - 访问 Google One 学生优惠页面
   - 检查是否显示 SheerID 验证链接

2. **页面加载问题**
   - 增加等待时间（`after_get_link` 延迟）
   - 检查网络连接
   - 确认代理有效

3. **页面结构变化**
   - Google 可能更新了页面结构
   - 查看日志中的详细错误
   - 可能需要更新代码

---

### Q4.3: 验证一直显示 pending？

**可能原因**：

1. **SheerID 审核慢**
   - 正常情况下 1-5 分钟
   - 高峰期可能更长

2. **API 轮询失败**
   - 检查网络连接
   - 查看日志中的错误信息

3. **验证信息不完整**
   - 确认 SheerID 表单已正确填写
   - 某些字段可能是必填的

---

## 5. 绑卡订阅问题

### Q5.1: 卡片信息填写失败？

**症状**：无法自动填写卡号、日期或 CVV

**可能原因**：

1. **页面元素变化**
   - Google 更新了支付页面
   - 需要更新选择器

2. **iframe 问题**
   - 卡片信息在 iframe 中
   - 需要先切换到 iframe

3. **页面未完全加载**
   - 增加等待时间
   - 等待元素可见

**调试方法**：

```python
# 查看页面结构
page.screenshot(path='debug_card_form.png')
print(page.content())
```

---

### Q5.2: 提示卡片被拒绝？

**可能原因**：

1. **卡片信息错误**
   - 检查卡号、日期、CVV
   - 确认格式正确

2. **卡片无效**
   - 卡片已过期
   - 余额不足
   - 卡片被冻结

3. **风控拦截**
   - Google 检测到异常
   - 使用不同的卡片
   - 更换 IP 地址

---

### Q5.3: 已经有订阅但仍尝试绑卡？

**症状**：账号已订阅，但系统仍尝试绑卡

**解决方案**：

1. **更新账号状态**
   ```sql
   UPDATE accounts 
   SET status = 'subscribed' 
   WHERE email = 'xxx@gmail.com';
   ```

2. **重新刷新列表**
   - 点击"刷新账号列表"
   - 确认状态已更新

---

### Q5.4: 绑卡后无法验证订阅？

**症状**：绑卡看起来成功，但无法确认

**检查方法**：

1. **手动验证**
   - 登录 Google 账号
   - 访问 Google One 设置
   - 查看订阅状态

2. **检查邮箱**
   - Google 会发送订阅确认邮件
   - 检查垃圾邮件文件夹

---

## 6. 性能和稳定性问题

### Q6.1: 程序运行很慢？

**优化建议**：

1. **减少并发数**
   - 降低线程数到 3
   - 减轻系统负担

2. **优化延迟**
   - 适当减少等待时间
   - 但不要过短（< 2秒）

3. **升级硬件**
   - 增加内存
   - 使用 SSD
   - 提升网络速度

4. **关闭不必要的程序**
   - 浏览器窗口
   - 其他自动化工具

---

### Q6.2: 程序经常崩溃？

**常见原因**：

1. **内存不足**
   - 减少并发数
   - 关闭其他程序
   - 重启电脑

2. **Playwright 超时**
   - 增加超时时间
   - 检查网络连接

3. **代码bug**
   - 查看详细错误日志
   - 更新到最新版本

**日志查看**：
```python
# 查看完整错误堆栈
import traceback
traceback.print_exc()
```

---

### Q6.3: 处理到一半停止了？

**可能原因**：

1. **网络中断**
   - 检查网络连接
   - 使用稳定的网络

2. **比特浏览器崩溃**
   - 重启比特浏览器
   - 减少并发窗口数

3. **程序异常**
   - 查看日志找到具体错误
   - 重新启动处理

---

## 7. 数据管理问题

### Q7.1: 如何备份数据？

**方法 1：备份数据库**

```bash
# 复制数据库文件
copy data\accounts.db data\backup\accounts_backup.db
```

**方法 2：导出为文本**

```bash
# 在程序中选择"导出账号"
# 或使用 SQLite 工具导出
```

**方法 3：完整备份**

```bash
# 备份整个 data 目录
xcopy /E /I data backup\data_20260119
```

---

### Q7.2: 数据库损坏？

**症状**：`database disk image is malformed`

**解决方案**：

#### 方案 A：从备份恢复

```bash
copy data\backup\accounts_backup.db data\accounts.db
```

#### 方案 B：尝试修复

```bash
# 使用 SQLite 工具
sqlite3 accounts.db
.recover
.dump > recovered.sql
```

#### 方案 C：重新导入

```bash
# 从文本文件重新导入
cd src
python migrate_txt_to_db.py
```

---

### Q7.3: 如何批量修改账号状态？

**使用 SQL**：

```sql
-- 重置所有失败账号
UPDATE accounts 
SET status = 'pending' 
WHERE status = 'failed';

-- 批量标记为已验证
UPDATE accounts 
SET status = 'verified' 
WHERE email IN (
    'user1@gmail.com',
    'user2@gmail.com'
);
```

**使用工具**：
- DB Browser for SQLite
- DBeaver
- 或任何 SQLite 客户端

---

## 8. 其他问题

### Q8.1: 文件编码错误？

**症状**：`UnicodeDecodeError` 或乱码

**解决方案**：

1. **转换为 UTF-8**
   - 使用 Notepad++ 打开文件
   - 选择"编码" → "转换为 UTF-8"
   - 保存

2. **使用正确的编辑器**
   - VS Code（推荐）
   - Notepad++
   - Sublime Text

3. **避免使用**：
   - Windows 记事本（可能使用 ANSI）
   - Word（会添加格式）

---

### Q8.2: 如何查看详细日志？

**方法 1：应用程序内查看**
- 右侧日志区域显示实时日志

**方法 2：保存日志到文件**

```python
# 在代码中添加
import logging
logging.basicConfig(
    filename='app.log',
    level=logging.DEBUG,
    format='%(asctime)s - %(levelname)s - %(message)s'
)
```

**方法 3：命令行运行**

```bash
cd src
python create_window_gui.py > log.txt 2>&1
```

---

### Q8.3: 程序界面显示异常？

**症状**：按钮重叠、文字显示不全等

**解决方案**：

1. **调整 Windows 显示缩放**
   - 设置 → 系统 → 显示
   - 将缩放设置为 100%

2. **更新显卡驱动**

3. **重新启动程序**

---

### Q8.4: 如何更新到最新版本？

**步骤**：

1. **备份数据**
   ```bash
   xcopy /E /I data backup\data_backup
   ```

2. **获取最新代码**
   ```bash
   git pull
   # 或下载最新版本
   ```

3. **更新依赖**
   ```bash
   pip install -r data/requirements.txt --upgrade
   ```

4. **恢复数据**
   ```bash
   copy backup\data_backup\accounts.db data\
   ```

---

### Q8.5: 如何联系技术支持？

如果以上方法都无法解决问题：

1. **收集信息**
   - 详细的错误信息
   - 日志文件
   - 截图
   - 系统环境（OS、Python 版本等）

2. **提交 Issue**
   - 在 GitHub 项目页面提交 Issue
   - 描述清楚问题和复现步骤

3. **附加诊断信息**
   ```bash
   # Python 版本
   python --version
   
   # 已安装包
   pip list > packages.txt
   
   # 系统信息
   systeminfo > systeminfo.txt
   ```

---

## 📝 诊断清单

遇到问题时，按此清单逐项检查：

### 基础环境
- [ ] Python 3.8+ 已安装
- [ ] 依赖包已安装（`pip list` 检查）
- [ ] Playwright 浏览器已安装

### 比特浏览器
- [ ] 比特浏览器已启动
- [ ] API 接口已启用
- [ ] 端口 54345 可访问
- [ ] 防火墙未拦截

### 数据文件
- [ ] accounts.txt 格式正确
- [ ] proxies.txt 格式正确
- [ ] cards.txt 格式正确
- [ ] 文件编码为 UTF-8

### 网络连接
- [ ] 网络连接正常
- [ ] 代理服务器可用
- [ ] 访问 Google 正常
- [ ] SheerID API 可访问

### 账号信息
- [ ] 邮箱和密码正确
- [ ] 2FA 密钥有效
- [ ] 备用邮箱正确
- [ ] 账号未被封禁

---

## 🆘 获取更多帮助

- **文档**: [README](./README.md) | [快速开始](./快速开始.md) | [功能说明](./功能说明.md)
- **日志**: 查看应用程序日志区域
- **测试**: 先用 1 个账号测试
- **社区**: 提交 Issue 或联系开发团队

---

**最后更新**: 2026-01-19  
**版本**: 2.0.0

如果本文档未能解决您的问题，请提交 Issue 并附上详细信息！

