# æ•°æ®åº“è®¾è®¡æ–‡æ¡£

## ğŸ“Š æ•°æ®åº“æ¦‚è¿°

**æ•°æ®åº“ç±»å‹**: PostgreSQL 14  
**æ•°æ®åº“åç§°**: auto_all_db  
**å­—ç¬¦é›†**: UTF-8  
**æ€»è¡¨æ•°**: 22ä¸ª

---

## ğŸ“‹ è¡¨æ¸…å•

| åºå· | è¡¨å | è¯´æ˜ | æ‰€å±æ¨¡å— |
|------|------|------|----------|
| 1 | accounts_user | ç”¨æˆ·è¡¨ | accounts |
| 2 | accounts_balance | ç”¨æˆ·ä½™é¢è¡¨ | accounts |
| 3 | accounts_balance_log | ä½™é¢å˜åŠ¨è®°å½•è¡¨ | accounts |
| 4 | zones_zone | ä¸“åŒºè¡¨ | zones |
| 5 | zones_config | ä¸“åŒºé…ç½®è¡¨ | zones |
| 6 | zones_user_access | ç”¨æˆ·ä¸“åŒºæƒé™è¡¨ | zones |
| 7 | tasks | ä»»åŠ¡è¡¨ | tasks |
| 8 | task_logs | ä»»åŠ¡æ—¥å¿—è¡¨ | tasks |
| 9 | task_statistics | ä»»åŠ¡ç»Ÿè®¡è¡¨ | tasks |
| 10 | cards | è™šæ‹Ÿå¡è¡¨ | cards |
| 11 | card_usage_logs | å¡ä½¿ç”¨è®°å½•è¡¨ | cards |
| 12 | orders | è®¢å•è¡¨ | payments |
| 13 | payments | æ”¯ä»˜è®°å½•è¡¨ | payments |
| 14 | payment_logs | æ”¯ä»˜æ—¥å¿—è¡¨ | payments |
| 15 | recharge_cards | å……å€¼å¡å¯†è¡¨ | payments |
| 16 | payment_configs | æ”¯ä»˜é…ç½®è¡¨ | payments |
| 17 | user_api_keys | ç”¨æˆ·APIkeyè¡¨ | integrations |
| 18 | proxies | ä»£ç†è¡¨ | integrations/proxies |
| 19 | google_accounts | Googleè´¦å·è¡¨ | integrations/google_accounts |
| 20 | sheerid_verifications | SheerIDéªŒè¯è®°å½•è¡¨ | integrations/google_accounts |
| 21 | gemini_subscriptions | Geminiè®¢é˜…è®°å½•è¡¨ | integrations/google_accounts |
| 22 | bitbrowser_profiles | æ¯”ç‰¹æµè§ˆå™¨é…ç½®è¡¨ | integrations/bitbrowser |

---

## ğŸ” è¯¦ç»†è¡¨ç»“æ„

### 1. accounts_user (ç”¨æˆ·è¡¨)

**è¯´æ˜**: æ‰©å±•Djangoè‡ªå¸¦Useræ¨¡å‹ï¼Œç®¡ç†ç³»ç»Ÿç”¨æˆ·

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | ç”¨æˆ·ID |
| username | VARCHAR | 150 | NO | - | å”¯ä¸€ | ç”¨æˆ·å |
| email | VARCHAR | 254 | NO | - | ç´¢å¼• | é‚®ç®±åœ°å€ |
| password | VARCHAR | 128 | NO | - | - | å¯†ç ï¼ˆåŠ å¯†ï¼‰ |
| first_name | VARCHAR | 150 | YES | - | - | å |
| last_name | VARCHAR | 150 | YES | - | - | å§“ |
| phone | VARCHAR | 20 | YES | - | - | æ‰‹æœºå· |
| avatar | VARCHAR | 500 | YES | - | - | å¤´åƒURL |
| role | VARCHAR | 20 | NO | user | ç´¢å¼• | ç”¨æˆ·è§’è‰² |
| is_verified | BOOLEAN | - | NO | false | - | æ˜¯å¦å·²éªŒè¯é‚®ç®± |
| is_active | BOOLEAN | - | NO | true | ç´¢å¼• | æ˜¯å¦æ¿€æ´» |
| is_staff | BOOLEAN | - | NO | false | - | æ˜¯å¦å‘˜å·¥ |
| is_superuser | BOOLEAN | - | NO | false | - | æ˜¯å¦è¶…çº§ç®¡ç†å‘˜ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•ä¿¡æ¯ |
| date_joined | TIMESTAMP | - | NO | now() | - | æ³¨å†Œæ—¶é—´ |
| last_login | TIMESTAMP | - | YES | - | - | æœ€åç™»å½•æ—¶é—´ |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- role: user(æ™®é€šç”¨æˆ·), admin(ç®¡ç†å‘˜), super_admin(è¶…çº§ç®¡ç†å‘˜)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (username)
- UNIQUE (email)
- INDEX (email)
- INDEX (role)
- INDEX (is_active)

**ä¸šåŠ¡æ–¹æ³•**:
- `is_admin` - æ˜¯å¦æ˜¯ç®¡ç†å‘˜ï¼ˆadminæˆ–super_adminï¼‰

---

### 2. accounts_balance (ç”¨æˆ·ä½™é¢è¡¨)

**è¯´æ˜**: ç®¡ç†ç”¨æˆ·è´¦æˆ·ä½™é¢

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | ä½™é¢è®°å½•ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+å”¯ä¸€ | ç”¨æˆ·ID |
| balance | DECIMAL | 10,2 | NO | 0.00 | - | ä½™é¢(å…ƒ) |
| currency | VARCHAR | 3 | NO | CNY | - | è´§å¸ç±»å‹ |
| frozen_amount | DECIMAL | 10,2 | NO | 0.00 | - | å†»ç»“é‡‘é¢(å…ƒ) |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**å¤–é”®å…³ç³»**:
- user â†’ accounts_user (OneToOne CASCADE)

**è®¡ç®—å±æ€§**:
- available_balance = balance - frozen_amount (å¯ç”¨ä½™é¢)

**ä¸šåŠ¡æ–¹æ³•**:
- `has_sufficient_balance(amount)` - æ£€æŸ¥ä½™é¢æ˜¯å¦å……è¶³
- `freeze_amount(amount)` - å†»ç»“é‡‘é¢
- `unfreeze_amount(amount)` - è§£å†»é‡‘é¢
- `deduct_balance(amount, description)` - æ‰£é™¤ä½™é¢ï¼ˆè‡ªåŠ¨åˆ›å»ºæ—¥å¿—ï¼‰
- `add_balance(amount, description)` - å¢åŠ ä½™é¢ï¼ˆè‡ªåŠ¨åˆ›å»ºæ—¥å¿—ï¼‰

---

### 3. accounts_balance_log (ä½™é¢å˜åŠ¨è®°å½•è¡¨)

**è¯´æ˜**: è®°å½•æ‰€æœ‰ä½™é¢å˜åŠ¨å†å²

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | æ—¥å¿—ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ç”¨æˆ·ID |
| amount | DECIMAL | 10,2 | NO | - | - | å˜åŠ¨é‡‘é¢(æ­£/è´Ÿ) |
| balance_before | DECIMAL | 10,2 | NO | - | - | å˜åŠ¨å‰ä½™é¢ |
| balance_after | DECIMAL | 10,2 | NO | - | - | å˜åŠ¨åä½™é¢ |
| type | VARCHAR | 20 | NO | - | ç´¢å¼• | å˜åŠ¨ç±»å‹ |
| description | TEXT | - | YES | - | - | è¯´æ˜ |
| related_order_id | BigInteger | - | YES | - | - | å…³è”è®¢å•ID |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•ä¿¡æ¯ |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |

**æšä¸¾å€¼**:
- type: recharge(å……å€¼), consume(æ¶ˆè´¹), refund(é€€æ¬¾), freeze(å†»ç»“), unfreeze(è§£å†»)

**å¤–é”®å…³ç³»**:
- user â†’ accounts_user (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (user, -created_at)
- INDEX (type)

---

### 4. zones_zone (ä¸“åŒºè¡¨)

**è¯´æ˜**: ç®¡ç†ç³»ç»Ÿå„ä¸ªåŠŸèƒ½ä¸“åŒº

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | ä¸“åŒºID |
| name | VARCHAR | 100 | NO | - | - | ä¸“åŒºåç§° |
| code | VARCHAR | 50 | NO | - | å”¯ä¸€+ç´¢å¼• | ä¸“åŒºä»£ç  |
| description | TEXT | - | YES | - | - | ä¸“åŒºæè¿° |
| icon | VARCHAR | 500 | YES | - | - | å›¾æ ‡URL |
| plugin_class | VARCHAR | 200 | NO | - | - | æ’ä»¶ç±»è·¯å¾„ |
| is_active | BOOLEAN | - | NO | true | ç´¢å¼• | æ˜¯å¦å¯ç”¨ |
| sort_order | INTEGER | - | NO | 0 | - | æ’åº |
| price_per_task | DECIMAL | 10,2 | YES | - | - | æ¯ä¸ªä»»åŠ¡ä»·æ ¼(å…ƒ) |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•é…ç½® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (code)
- INDEX (code)
- INDEX (is_active)

**è¡¨å**: zones_zone

---

### 5. zones_config (ä¸“åŒºé…ç½®è¡¨)

**è¯´æ˜**: å­˜å‚¨ä¸“åŒºçš„é…ç½®é¡¹

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | é…ç½®ID |
| zone_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ä¸“åŒºID |
| config_key | VARCHAR | 100 | NO | - | - | é…ç½®é”® |
| config_value | TEXT | - | YES | - | - | é…ç½®å€¼ |
| value_type | VARCHAR | 20 | NO | string | - | å€¼ç±»å‹ |
| description | TEXT | - | YES | - | - | é…ç½®è¯´æ˜ |
| is_secret | BOOLEAN | - | NO | false | - | æ˜¯å¦æ•æ„Ÿä¿¡æ¯ |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- value_type: string, number, boolean, json

**å¤–é”®å…³ç³»**:
- zone â†’ zones_zone (CASCADE)

**å”¯ä¸€çº¦æŸ**:
- UNIQUE (zone, config_key)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (zone)

**è¡¨å**: zones_config

---

### 6. zones_user_access (ç”¨æˆ·ä¸“åŒºæƒé™è¡¨)

**è¯´æ˜**: ç®¡ç†ç”¨æˆ·å¯¹ä¸“åŒºçš„è®¿é—®æƒé™

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | æƒé™ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ç”¨æˆ·ID |
| zone_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ä¸“åŒºID |
| is_enabled | BOOLEAN | - | NO | true | - | æ˜¯å¦å¯ç”¨ |
| quota_limit | INTEGER | - | NO | -1 | - | é…é¢é™åˆ¶(-1=æ— é™) |
| quota_used | INTEGER | - | NO | 0 | - | å·²ä½¿ç”¨é…é¢ |
| expires_at | TIMESTAMP | - | YES | - | - | è¿‡æœŸæ—¶é—´ |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**å¤–é”®å…³ç³»**:
- user â†’ accounts_user (CASCADE)
- zone â†’ zones_zone (CASCADE)

**å”¯ä¸€çº¦æŸ**:
- UNIQUE (user, zone)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (user)
- INDEX (zone)

**ä¸šåŠ¡æ–¹æ³•**:
- `can_access()` - æ£€æŸ¥æ˜¯å¦å¯ä»¥è®¿é—®ï¼ˆè€ƒè™‘å¯ç”¨çŠ¶æ€ã€è¿‡æœŸæ—¶é—´ã€é…é¢é™åˆ¶ï¼‰

**è¡¨å**: zones_user_access

---

### 7. tasks (ä»»åŠ¡è¡¨)

**è¯´æ˜**: è®°å½•æ‰€æœ‰ç”¨æˆ·æäº¤çš„ä»»åŠ¡

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | ä»»åŠ¡ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ç”¨æˆ·ID |
| zone_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ä¸“åŒºID |
| task_type | VARCHAR | 100 | NO | - | - | ä»»åŠ¡ç±»å‹ |
| status | VARCHAR | 20 | NO | pending | ç´¢å¼• | ä»»åŠ¡çŠ¶æ€ |
| priority | VARCHAR | 20 | NO | normal | - | ä¼˜å…ˆçº§ |
| progress | INTEGER | - | NO | 0 | - | è¿›åº¦(0-100) |
| input_data | JSONB | - | NO | {} | - | è¾“å…¥æ•°æ® |
| output_data | JSONB | - | NO | {} | - | è¾“å‡ºæ•°æ® |
| error_message | TEXT | - | YES | - | - | é”™è¯¯ä¿¡æ¯ |
| cost_amount | DECIMAL | 10,2 | NO | 0 | - | æ¶ˆè€—é‡‘é¢(å…ƒ) |
| celery_task_id | VARCHAR | 255 | YES | - | ç´¢å¼• | Celeryä»»åŠ¡ID |
| start_time | TIMESTAMP | - | YES | - | - | å¼€å§‹æ—¶é—´ |
| end_time | TIMESTAMP | - | YES | - | - | ç»“æŸæ—¶é—´ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- status: pending(å¾…å¤„ç†), running(æ‰§è¡Œä¸­), success(æˆåŠŸ), failed(å¤±è´¥), cancelled(å·²å–æ¶ˆ)
- priority: low(ä½), normal(æ™®é€š), high(é«˜), urgent(ç´§æ€¥)

**å¤–é”®å…³ç³»**:
- user â†’ accounts_user (CASCADE)
- zone â†’ zones_zone (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (user, status)
- INDEX (zone, status)
- INDEX (status, created_at)
- INDEX (celery_task_id)

**è®¡ç®—å±æ€§**:
- duration = end_time - start_time (ä»»åŠ¡æ‰§è¡Œæ—¶é•¿)

**ä¸šåŠ¡æ–¹æ³•**:
- `is_finished()` - æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²å®Œæˆï¼ˆæˆåŠŸã€å¤±è´¥æˆ–å–æ¶ˆï¼‰

**è¡¨å**: tasks

---

### 8. task_logs (ä»»åŠ¡æ—¥å¿—è¡¨)

**è¯´æ˜**: è®°å½•ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹çš„è¯¦ç»†æ—¥å¿—

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | æ—¥å¿—ID |
| task_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ä»»åŠ¡ID |
| level | VARCHAR | 20 | NO | info | ç´¢å¼• | æ—¥å¿—çº§åˆ« |
| message | TEXT | - | NO | - | - | æ—¥å¿—æ¶ˆæ¯ |
| step | VARCHAR | 100 | YES | - | - | æ‰§è¡Œæ­¥éª¤ |
| extra_data | JSONB | - | YES | {} | - | é¢å¤–æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |

**æšä¸¾å€¼**:
- level: debug(è°ƒè¯•), info(ä¿¡æ¯), warning(è­¦å‘Š), error(é”™è¯¯)

**å¤–é”®å…³ç³»**:
- task â†’ tasks (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (task, level)
- INDEX (task, created_at)

**è¡¨å**: task_logs

---

### 9. task_statistics (ä»»åŠ¡ç»Ÿè®¡è¡¨)

**è¯´æ˜**: è®°å½•æ¯æ—¥/æ¯å‘¨/æ¯æœˆçš„ä»»åŠ¡ç»Ÿè®¡æ•°æ®

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | ç»Ÿè®¡ID |
| zone_id | BigInteger | - | NO | - | å¤–é”® | ä¸“åŒºID |
| date | DATE | - | NO | - | ç´¢å¼• | ç»Ÿè®¡æ—¥æœŸ |
| period_type | VARCHAR | 20 | NO | daily | - | ç»Ÿè®¡å‘¨æœŸ |
| total_tasks | INTEGER | - | NO | 0 | - | æ€»ä»»åŠ¡æ•° |
| success_tasks | INTEGER | - | NO | 0 | - | æˆåŠŸä»»åŠ¡æ•° |
| failed_tasks | INTEGER | - | NO | 0 | - | å¤±è´¥ä»»åŠ¡æ•° |
| total_cost | DECIMAL | 12,2 | NO | 0 | - | æ€»æ¶ˆè€—é‡‘é¢(å…ƒ) |
| avg_duration | FLOAT | - | NO | 0 | - | å¹³å‡æ‰§è¡Œæ—¶é•¿(ç§’) |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- period_type: daily(æ—¥), weekly(å‘¨), monthly(æœˆ)

**å¤–é”®å…³ç³»**:
- zone â†’ zones_zone (CASCADE)

**å”¯ä¸€çº¦æŸ**:
- UNIQUE (zone, date, period_type)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (date)

**è®¡ç®—å±æ€§**:
- success_rate = (success_tasks / total_tasks) * 100 (æˆåŠŸç‡)

**è¡¨å**: task_statistics

---

### 10. cards (è™šæ‹Ÿå¡è¡¨)

**è¯´æ˜**: ç®¡ç†è™šæ‹Ÿå¡ï¼Œæ”¯æŒå…¬å…±å¡æ± å’Œç§æœ‰å¡

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | å¡ID |
| card_number | VARCHAR | 20 | NO | - | - | å¡å·(åŠ å¯†) |
| card_holder | VARCHAR | 100 | YES | - | - | æŒå¡äººå§“å |
| expiry_month | INTEGER | - | NO | - | - | è¿‡æœŸæœˆä»½(1-12) |
| expiry_year | INTEGER | - | NO | - | - | è¿‡æœŸå¹´ä»½(2024-2099) |
| cvv | VARCHAR | 4 | NO | - | - | CVV(åŠ å¯†) |
| card_type | VARCHAR | 20 | NO | visa | - | å¡ç±»å‹ |
| bank_name | VARCHAR | 100 | YES | - | - | é“¶è¡Œåç§° |
| balance | DECIMAL | 10,2 | NO | 0.00 | - | å¡ä½™é¢(å…ƒ) |
| pool_type | VARCHAR | 20 | NO | public | ç´¢å¼• | å¡æ± ç±»å‹ |
| owner_user_id | BigInteger | - | YES | - | å¤–é”®+ç´¢å¼• | æ‰€æœ‰è€…ID |
| status | VARCHAR | 20 | NO | available | ç´¢å¼• | å¡çŠ¶æ€ |
| use_count | INTEGER | - | NO | 0 | - | ä½¿ç”¨æ¬¡æ•° |
| success_count | INTEGER | - | NO | 0 | - | æˆåŠŸæ¬¡æ•° |
| max_use_count | INTEGER | - | NO | 1 | - | æœ€å¤§ä½¿ç”¨æ¬¡æ•°(0=æ— é™) |
| billing_address | JSONB | - | YES | {} | - | è´¦å•åœ°å€ |
| notes | TEXT | - | YES | - | - | å¤‡æ³¨ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |
| last_used_at | TIMESTAMP | - | YES | - | - | æœ€åä½¿ç”¨æ—¶é—´ |

**æšä¸¾å€¼**:
- pool_type: public(å…¬å…±å¡æ± ), private(ç§æœ‰å¡æ± )
- status: available(å¯ç”¨), in_use(ä½¿ç”¨ä¸­), used(å·²ä½¿ç”¨), invalid(æ— æ•ˆ), expired(å·²è¿‡æœŸ)
- card_type: visa, mastercard, amex, other

**å¤–é”®å…³ç³»**:
- owner_user â†’ accounts_user (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (pool_type, status)
- INDEX (owner_user, status)
- INDEX (status, created_at DESC)

**è®¡ç®—å±æ€§**:
- masked_card_number = "****" + last 4 digits (è„±æ•å¡å·)
- success_rate = (success_count / use_count) * 100 (æˆåŠŸç‡)

**ä¸šåŠ¡æ–¹æ³•**:
- `is_available()` - æ£€æŸ¥å¡æ˜¯å¦å¯ç”¨
- `is_expired()` - æ£€æŸ¥å¡æ˜¯å¦è¿‡æœŸ

---

### 11. card_usage_logs (å¡ä½¿ç”¨è®°å½•è¡¨)

**è¯´æ˜**: è®°å½•æ¯æ¬¡ä½¿ç”¨è™šæ‹Ÿå¡çš„è¯¦ç»†ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | è®°å½•ID |
| card_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | è™šæ‹Ÿå¡ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ä½¿ç”¨è€…ID |
| task_id | BigInteger | - | YES | - | å¤–é”®+ç´¢å¼• | å…³è”ä»»åŠ¡ID |
| purpose | VARCHAR | 200 | NO | - | - | ä½¿ç”¨ç›®çš„ |
| success | BOOLEAN | - | NO | false | ç´¢å¼• | æ˜¯å¦æˆåŠŸ |
| error_message | TEXT | - | YES | - | - | é”™è¯¯ä¿¡æ¯ |
| transaction_id | VARCHAR | 200 | YES | - | - | äº¤æ˜“ID |
| amount | DECIMAL | 10,2 | NO | 0 | - | äº¤æ˜“é‡‘é¢(å…ƒ) |
| currency | VARCHAR | 10 | NO | CNY | - | è´§å¸å•ä½ |
| extra_data | JSONB | - | YES | {} | - | é¢å¤–æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | ä½¿ç”¨æ—¶é—´ |

**å¤–é”®å…³ç³»**:
- card â†’ cards (CASCADE)
- user â†’ accounts_user (CASCADE)
- task â†’ tasks.Task (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (card, success)
- INDEX (user, created_at)
- INDEX (task, created_at)

**è¡¨å**: card_usage_logs

---

### 12. orders (è®¢å•è¡¨)

**è¯´æ˜**: è®°å½•ç”¨æˆ·å……å€¼ã€è´­ä¹°æœåŠ¡ç­‰è®¢å•

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | è®¢å•ID |
| order_no | VARCHAR | 64 | NO | - | å”¯ä¸€+ç´¢å¼• | è®¢å•å· |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ç”¨æˆ·ID |
| amount | DECIMAL | 10,2 | NO | - | - | è®¢å•é‡‘é¢(å…ƒ) |
| currency | VARCHAR | 10 | NO | CNY | - | è´§å¸å•ä½ |
| actual_amount | DECIMAL | 10,2 | YES | - | - | å®é™…æ”¯ä»˜é‡‘é¢(å…ƒ) |
| order_type | VARCHAR | 50 | NO | - | ç´¢å¼• | è®¢å•ç±»å‹ |
| status | VARCHAR | 20 | NO | pending | ç´¢å¼• | è®¢å•çŠ¶æ€ |
| description | VARCHAR | 500 | YES | - | - | è®¢å•æè¿° |
| items | JSONB | - | YES | [] | - | è®¢å•é¡¹åˆ—è¡¨ |
| payment_method | VARCHAR | 50 | YES | - | - | æ”¯ä»˜æ–¹å¼ |
| paid_at | TIMESTAMP | - | YES | - | - | æ”¯ä»˜æ—¶é—´ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- order_type: recharge(å……å€¼), service_purchase(æœåŠ¡è´­ä¹°), vip(VIPè®¢é˜…)
- status: pending(å¾…æ”¯ä»˜), paid(å·²æ”¯ä»˜), processing(å¤„ç†ä¸­), completed(å·²å®Œæˆ), cancelled(å·²å–æ¶ˆ), refunded(å·²é€€æ¬¾)

**å¤–é”®å…³ç³»**:
- user â†’ accounts_user (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (order_no)
- INDEX (user, status)
- INDEX (status, created_at)
- INDEX (order_type, status)

**è®¡ç®—å±æ€§**:
- discount_amount = amount - actual_amount (ä¼˜æƒ é‡‘é¢)

**è¡¨å**: orders

---

### 13. payments (æ”¯ä»˜è®°å½•è¡¨)

**è¯´æ˜**: è®°å½•æ¯ç¬”æ”¯ä»˜äº¤æ˜“çš„è¯¦ç»†ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | æ”¯ä»˜ID |
| payment_no | VARCHAR | 64 | NO | - | å”¯ä¸€+ç´¢å¼• | æ”¯ä»˜å•å· |
| order_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | è®¢å•ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ç”¨æˆ·ID |
| gateway | VARCHAR | 50 | NO | - | ç´¢å¼• | æ”¯ä»˜ç½‘å…³ |
| transaction_id | VARCHAR | 200 | YES | - | - | ç¬¬ä¸‰æ–¹äº¤æ˜“ID |
| amount | DECIMAL | 10,2 | NO | - | - | æ”¯ä»˜é‡‘é¢(å…ƒ) |
| currency | VARCHAR | 10 | NO | CNY | - | è´§å¸å•ä½ |
| status | VARCHAR | 20 | NO | pending | ç´¢å¼• | æ”¯ä»˜çŠ¶æ€ |
| pay_url | URLField | - | YES | - | - | æ”¯ä»˜é“¾æ¥ |
| qr_code | TEXT | - | YES | - | - | æ”¯ä»˜äºŒç»´ç  |
| notify_data | JSONB | - | YES | {} | - | å›è°ƒæ•°æ® |
| paid_at | TIMESTAMP | - | YES | - | - | æ”¯ä»˜å®Œæˆæ—¶é—´ |
| expired_at | TIMESTAMP | - | YES | - | - | æ”¯ä»˜è¿‡æœŸæ—¶é—´ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- gateway: alipay(æ”¯ä»˜å®), wechat(å¾®ä¿¡æ”¯ä»˜), stripe(Stripe), paypal(PayPal), card_code(å¡å¯†å……å€¼)
- status: pending(å¾…æ”¯ä»˜), processing(å¤„ç†ä¸­), success(æ”¯ä»˜æˆåŠŸ), failed(æ”¯ä»˜å¤±è´¥), cancelled(å·²å–æ¶ˆ), refunded(å·²é€€æ¬¾)

**å¤–é”®å…³ç³»**:
- order â†’ orders (CASCADE)
- user â†’ accounts_user (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (payment_no)
- INDEX (order, status)
- INDEX (user, status)
- INDEX (gateway, status)
- INDEX (status, created_at)

**è¡¨å**: payments

---

### 14. payment_logs (æ”¯ä»˜æ—¥å¿—è¡¨)

**è¯´æ˜**: è®°å½•æ”¯ä»˜è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ“ä½œå’Œå›è°ƒ

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | æ—¥å¿—ID |
| payment_id | BigInteger | - | NO | - | å¤–é”® | æ”¯ä»˜è®°å½•ID |
| log_type | VARCHAR | 20 | NO | - | - | æ—¥å¿—ç±»å‹ |
| message | TEXT | - | NO | - | - | æ—¥å¿—æ¶ˆæ¯ |
| request_data | JSONB | - | YES | {} | - | è¯·æ±‚æ•°æ® |
| response_data | JSONB | - | YES | {} | - | å“åº”æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |

**æšä¸¾å€¼**:
- log_type: create(åˆ›å»º), query(æŸ¥è¯¢), notify(å›è°ƒé€šçŸ¥), refund(é€€æ¬¾)

**å¤–é”®å…³ç³»**:
- payment â†’ payments (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)

**è¡¨å**: payment_logs

---

### 15. recharge_cards (å……å€¼å¡å¯†è¡¨)

**è¯´æ˜**: ç®¡ç†å……å€¼å¡å¯†ï¼Œæ”¯æŒæ‰¹é‡ç”Ÿæˆå’Œä½¿ç”¨

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | å¡å¯†ID |
| card_code | VARCHAR | 32 | NO | - | å”¯ä¸€+ç´¢å¼• | å¡å¯† |
| amount | DECIMAL | 10,2 | NO | - | - | é¢å€¼(å…ƒ) |
| status | VARCHAR | 20 | NO | unused | ç´¢å¼• | å¡å¯†çŠ¶æ€ |
| used_by_id | BigInteger | - | YES | - | å¤–é”® | ä½¿ç”¨è€…ID |
| used_at | TIMESTAMP | - | YES | - | - | ä½¿ç”¨æ—¶é—´ |
| created_by_id | BigInteger | - | YES | - | å¤–é”®+ç´¢å¼• | åˆ›å»ºè€…ID |
| batch_no | VARCHAR | 64 | YES | - | ç´¢å¼• | æ‰¹æ¬¡å· |
| expires_at | TIMESTAMP | - | YES | - | - | è¿‡æœŸæ—¶é—´ |
| notes | TEXT | - | YES | - | - | å¤‡æ³¨ |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- status: unused(æœªä½¿ç”¨), used(å·²ä½¿ç”¨), expired(å·²è¿‡æœŸ), disabled(å·²ç¦ç”¨)

**å¤–é”®å…³ç³»**:
- used_by â†’ accounts_user (SET NULL)
- created_by â†’ accounts_user (SET NULL)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (card_code)
- INDEX (status, amount)
- INDEX (batch_no)
- INDEX (created_by, created_at)

**ä¸šåŠ¡æ–¹æ³•**:
- `generate_card_code(prefix='')` - ç”Ÿæˆå¡å¯†
- `batch_generate(count, amount, ...)` - æ‰¹é‡ç”Ÿæˆ
- `use_card(user)` - ä½¿ç”¨å¡å¯†å……å€¼

**è¡¨å**: recharge_cards

---

### 16. payment_configs (æ”¯ä»˜é…ç½®è¡¨)

**è¯´æ˜**: ç®¡ç†å„ç§æ”¯ä»˜æ–¹å¼çš„å¼€å…³å’Œé…ç½®

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | é…ç½®ID |
| gateway | VARCHAR | 50 | NO | - | å”¯ä¸€ | æ”¯ä»˜ç½‘å…³ |
| name | VARCHAR | 100 | NO | - | - | æ˜¾ç¤ºåç§° |
| is_enabled | BOOLEAN | - | NO | true | - | æ˜¯å¦å¯ç”¨ |
| sort_order | INTEGER | - | NO | 0 | - | æ’åº |
| icon | VARCHAR | 200 | YES | - | - | å›¾æ ‡ |
| config_data | JSONB | - | YES | {} | - | é…ç½®æ•°æ® |
| fee_rate | DECIMAL | 5,4 | NO | 0 | - | æ‰‹ç»­è´¹ç‡ |
| min_amount | DECIMAL | 10,2 | NO | 1 | - | æœ€å°é‡‘é¢(å…ƒ) |
| max_amount | DECIMAL | 10,2 | NO | 10000 | - | æœ€å¤§é‡‘é¢(å…ƒ) |
| description | TEXT | - | YES | - | - | è¯´æ˜ |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (gateway)

**è¡¨å**: payment_configs

---

### 17. user_api_keys (ç”¨æˆ·APIkeyè¡¨)

**è¯´æ˜**: å…è®¸ç”¨æˆ·ä½¿ç”¨è‡ªå·±çš„ç¬¬ä¸‰æ–¹æœåŠ¡APIkey

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | APIkeyè®°å½•ID |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | ç”¨æˆ·ID |
| service | VARCHAR | 100 | NO | - | ç´¢å¼• | æœåŠ¡åç§° |
| key_name | VARCHAR | 200 | NO | - | - | Keyåç§° |
| api_key_encrypted | TEXT | - | NO | - | - | APIkey(åŠ å¯†) |
| usage_quota_limit | INTEGER | - | NO | 0 | - | é…é¢ä¸Šé™(0=æ— é™) |
| usage_quota_used | INTEGER | - | NO | 0 | - | å·²ä½¿ç”¨é…é¢ |
| is_active | BOOLEAN | - | NO | true | ç´¢å¼• | æ˜¯å¦æ¿€æ´» |
| is_valid | BOOLEAN | - | NO | true | - | æ˜¯å¦æœ‰æ•ˆ |
| last_validated_at | TIMESTAMP | - | YES | - | - | æœ€åéªŒè¯æ—¶é—´ |
| validation_error | TEXT | - | YES | - | - | éªŒè¯é”™è¯¯ä¿¡æ¯ |
| use_count | INTEGER | - | NO | 0 | - | ä½¿ç”¨æ¬¡æ•° |
| success_count | INTEGER | - | NO | 0 | - | æˆåŠŸæ¬¡æ•° |
| last_used_at | TIMESTAMP | - | YES | - | - | æœ€åä½¿ç”¨æ—¶é—´ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æœåŠ¡ç±»å‹ç¤ºä¾‹**:
- sheerid, google, openai, stripe

**å¤–é”®å…³ç³»**:
- user â†’ accounts_user (CASCADE)

**å”¯ä¸€çº¦æŸ**:
- UNIQUE (user, service, key_name)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (user, service, is_active)
- INDEX (service, is_valid)

**è®¡ç®—å±æ€§**:
- masked_api_key = first 4 chars + "..." + last 4 chars (è„±æ•APIkey)
- quota_remaining = usage_quota_limit - usage_quota_used (å‰©ä½™é…é¢)
- success_rate = (success_count / use_count) * 100 (æˆåŠŸç‡)

**ä¸šåŠ¡æ–¹æ³•**:
- `set_api_key(plain_key)` - åŠ å¯†å¹¶ä¿å­˜APIkey
- `get_api_key()` - è§£å¯†å¹¶è¿”å›APIkey

**è¡¨å**: user_api_keys

---

### 18. proxies (ä»£ç†è¡¨)

**è¯´æ˜**: ç®¡ç†ç”¨äºè‡ªåŠ¨åŒ–ä»»åŠ¡çš„ä»£ç†IP

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | ä»£ç†ID |
| proxy_type | VARCHAR | 20 | NO | http | - | ä»£ç†ç±»å‹ |
| host | VARCHAR | 255 | NO | - | - | ä»£ç†ä¸»æœº |
| port | INTEGER | - | NO | - | - | ç«¯å£ |
| username | VARCHAR | 100 | YES | - | - | ç”¨æˆ·å |
| password | VARCHAR | 255 | YES | - | - | å¯†ç (åŠ å¯†) |
| country | VARCHAR | 100 | YES | - | ç´¢å¼• | å›½å®¶ |
| region | VARCHAR | 100 | YES | - | - | åœ°åŒº |
| city | VARCHAR | 100 | YES | - | - | åŸå¸‚ |
| status | VARCHAR | 20 | NO | active | ç´¢å¼• | çŠ¶æ€ |
| response_time | FLOAT | - | NO | 0 | - | å“åº”æ—¶é—´(ms) |
| success_rate | FLOAT | - | NO | 100 | - | æˆåŠŸç‡(%) |
| use_count | INTEGER | - | NO | 0 | - | ä½¿ç”¨æ¬¡æ•° |
| last_used_at | TIMESTAMP | - | YES | - | - | æœ€åä½¿ç”¨æ—¶é—´ |
| last_check_at | TIMESTAMP | - | YES | - | - | æœ€åæ£€æŸ¥æ—¶é—´ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- proxy_type: http(HTTP), https(HTTPS), socks5(SOCKS5)
- status: active(å¯ç”¨), inactive(ä¸å¯ç”¨), testing(æµ‹è¯•ä¸­)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (status, country)
- INDEX (status, success_rate)

**è®¡ç®—å±æ€§**:
- proxy_url = "type://[username:password@]host:port" (ä»£ç†URL)

**è¡¨å**: proxies

---

### 19. google_accounts (Googleè´¦å·è¡¨)

**è¯´æ˜**: ç®¡ç†Googleè´¦å·åŠå…¶Geminiè®¢é˜…çŠ¶æ€

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | è´¦å·ID |
| email | VARCHAR | 254 | NO | - | å”¯ä¸€+ç´¢å¼• | Googleé‚®ç®± |
| password | VARCHAR | 255 | NO | - | - | å¯†ç (åŠ å¯†) |
| recovery_email | VARCHAR | 254 | YES | - | - | æ¢å¤é‚®ç®± |
| phone_number | VARCHAR | 20 | YES | - | - | ç»‘å®šæ‰‹æœºå· |
| two_fa_enabled | BOOLEAN | - | NO | false | - | æ˜¯å¦å¯ç”¨2FA |
| two_fa_secret | VARCHAR | 255 | YES | - | - | 2FAå¯†é’¥(åŠ å¯†) |
| status | VARCHAR | 20 | NO | pending_verify | ç´¢å¼• | è´¦å·çŠ¶æ€ |
| gemini_status | VARCHAR | 20 | NO | not_subscribed | ç´¢å¼• | GeminiçŠ¶æ€ |
| sheerid_verified | BOOLEAN | - | NO | false | - | æ˜¯å¦é€šè¿‡SheerIDéªŒè¯ |
| sheerid_link | TEXT | - | YES | - | - | SheerIDéªŒè¯é“¾æ¥ |
| card_bound | BOOLEAN | - | NO | false | - | æ˜¯å¦å·²ç»‘å¡ |
| owner_user_id | BigInteger | - | YES | - | å¤–é”®+ç´¢å¼• | è´¦å·æ‰€æœ‰è€…ID |
| last_login_at | TIMESTAMP | - | YES | - | - | æœ€åç™»å½•æ—¶é—´ |
| last_login_ip | INET | - | YES | - | - | æœ€åç™»å½•IP |
| subscription_start_date | DATE | - | YES | - | - | è®¢é˜…å¼€å§‹æ—¥æœŸ |
| subscription_end_date | DATE | - | YES | - | ç´¢å¼• | è®¢é˜…ç»“æŸæ—¥æœŸ |
| bound_card_id | BigInteger | - | YES | - | å¤–é”® | ç»‘å®šçš„è™šæ‹Ÿå¡ID |
| notes | TEXT | - | YES | - | - | å¤‡æ³¨ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- status: active(æ­£å¸¸), locked(é”å®š), disabled(åœç”¨), pending_verify(å¾…éªŒè¯)
- gemini_status: not_subscribed(æœªè®¢é˜…), pending(è®¢é˜…ä¸­), active(å·²è®¢é˜…), expired(å·²è¿‡æœŸ), cancelled(å·²å–æ¶ˆ)

**å¤–é”®å…³ç³»**:
- owner_user_id â†’ accounts_user.id (CASCADE)
- bound_card_id â†’ cards.id (SET NULL)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (email)
- INDEX (status, gemini_status)
- INDEX (owner_user_id, status)
- INDEX (gemini_status, subscription_end_date)

**è®¡ç®—å±æ€§**:
- is_subscription_active = (gemini_status == 'active' && subscription_end_date >= today) (è®¢é˜…æ˜¯å¦æœ‰æ•ˆ)

---

### 20. sheerid_verifications (SheerIDéªŒè¯è®°å½•è¡¨)

**è¯´æ˜**: è®°å½•æ¯æ¬¡SheerIDå­¦ç”Ÿ/æ•™å¸ˆéªŒè¯çš„è¯¦ç»†ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | éªŒè¯è®°å½•ID |
| google_account_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | Googleè´¦å·ID |
| task_id | BigInteger | - | YES | - | å¤–é”®+ç´¢å¼• | å…³è”ä»»åŠ¡ID |
| verification_type | VARCHAR | 50 | NO | - | - | éªŒè¯ç±»å‹ |
| verification_link | TEXT | - | NO | - | - | SheerIDéªŒè¯é“¾æ¥ |
| submitted_data | JSONB | - | NO | {} | - | æäº¤çš„éªŒè¯æ•°æ® |
| verified | BOOLEAN | - | NO | false | ç´¢å¼• | æ˜¯å¦é€šè¿‡éªŒè¯ |
| verified_at | TIMESTAMP | - | YES | - | - | é€šè¿‡æ—¶é—´ |
| error_message | TEXT | - | YES | - | - | å¤±è´¥åŸå›  |
| extra_data | JSONB | - | YES | {} | - | é¢å¤–æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**æšä¸¾å€¼**:
- verification_type: student(å­¦ç”Ÿ), teacher(æ•™å¸ˆ)

**å¤–é”®å…³ç³»**:
- google_account_id â†’ google_accounts.id (CASCADE)
- task_id â†’ tasks.id (CASCADE)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (google_account_id, verified)
- INDEX (task_id, verified)

---

### 21. gemini_subscriptions (Geminiè®¢é˜…è®°å½•è¡¨)

**è¯´æ˜**: è®°å½•æ¯æ¬¡Geminiè®¢é˜…æ“ä½œçš„è¯¦ç»†ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | è®¢é˜…è®°å½•ID |
| google_account_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | Googleè´¦å·ID |
| task_id | BigInteger | - | YES | - | å¤–é”®+ç´¢å¼• | å…³è”ä»»åŠ¡ID |
| card_id | BigInteger | - | YES | - | å¤–é”® | ä½¿ç”¨çš„è™šæ‹Ÿå¡ID |
| subscription_plan | VARCHAR | 50 | NO | Advanced | - | è®¢é˜…è®¡åˆ’ |
| start_date | DATE | - | NO | - | ç´¢å¼• | è®¢é˜…å¼€å§‹æ—¥æœŸ |
| end_date | DATE | - | YES | - | - | è®¢é˜…ç»“æŸæ—¥æœŸ |
| amount | DECIMAL | 10,2 | NO | 0 | - | è®¢é˜…è´¹ç”¨(å…ƒ) |
| success | BOOLEAN | - | NO | false | ç´¢å¼• | æ˜¯å¦æˆåŠŸ |
| error_message | TEXT | - | YES | - | - | å¤±è´¥åŸå›  |
| extra_data | JSONB | - | YES | {} | - | é¢å¤–æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**å¤–é”®å…³ç³»**:
- google_account_id â†’ google_accounts.id (CASCADE)
- task_id â†’ tasks.id (CASCADE)
- card_id â†’ cards.id (SET NULL)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- INDEX (google_account_id, success)
- INDEX (task_id, success)
- INDEX (success, start_date)

---

### 22. bitbrowser_profiles (æ¯”ç‰¹æµè§ˆå™¨é…ç½®è¡¨)

**è¯´æ˜**: å­˜å‚¨æµè§ˆå™¨é…ç½®ã€æŒ‡çº¹ä¿¡æ¯ç­‰

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|--------|--------|------|------|
| id | BigInteger | - | NO | è‡ªå¢ | ä¸»é”® | é…ç½®ID |
| profile_id | VARCHAR | 100 | NO | - | å”¯ä¸€+ç´¢å¼• | æ¯”ç‰¹æµè§ˆå™¨é…ç½®ID |
| profile_name | VARCHAR | 200 | NO | - | - | é…ç½®åç§° |
| user_id | BigInteger | - | NO | - | å¤–é”®+ç´¢å¼• | æ‰€å±ç”¨æˆ·ID |
| google_account_id | BigInteger | - | YES | - | å¤–é”® | å…³è”çš„Googleè´¦å·ID |
| proxy_id | BigInteger | - | YES | - | å¤–é”® | ä½¿ç”¨çš„ä»£ç†ID |
| browser_config | JSONB | - | NO | {} | - | æµè§ˆå™¨é…ç½® |
| fingerprint_config | JSONB | - | NO | {} | - | æŒ‡çº¹é…ç½® |
| is_active | BOOLEAN | - | NO | true | ç´¢å¼• | æ˜¯å¦æ¿€æ´» |
| use_count | INTEGER | - | NO | 0 | - | ä½¿ç”¨æ¬¡æ•° |
| last_used_at | TIMESTAMP | - | YES | - | - | æœ€åä½¿ç”¨æ—¶é—´ |
| metadata | JSONB | - | YES | {} | - | æ‰©å±•æ•°æ® |
| created_at | TIMESTAMP | - | NO | now() | - | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | - | NO | now() | - | æ›´æ–°æ—¶é—´ |

**å¤–é”®å…³ç³»**:
- user_id â†’ accounts_user.id (CASCADE)
- google_account_id â†’ google_accounts.id (SET NULL)
- proxy_id â†’ proxies.id (SET NULL)

**ç´¢å¼•**:
- PRIMARY KEY (id)
- UNIQUE (profile_id)
- INDEX (user_id, is_active)
- INDEX (google_account_id)

---

## ğŸ”— è¡¨å…³ç³»å›¾

### æ ¸å¿ƒå…³ç³»

```
accounts_user (ç”¨æˆ·)
    â”œâ”€â†’ accounts_balance (1å¯¹1)
    â”œâ”€â†’ accounts_balance_log (1å¯¹å¤š)
    â”œâ”€â†’ zones_user_access (å¤šå¯¹å¤š via zones)
    â”œâ”€â†’ tasks (1å¯¹å¤š)
    â”œâ”€â†’ cards (1å¯¹å¤š, ç§æœ‰å¡)
    â”œâ”€â†’ card_usage_logs (1å¯¹å¤š)
    â”œâ”€â†’ orders (1å¯¹å¤š)
    â”œâ”€â†’ payments (1å¯¹å¤š)
    â”œâ”€â†’ user_api_keys (1å¯¹å¤š)
    â”œâ”€â†’ google_accounts (1å¯¹å¤š, ç§æœ‰è´¦å·)
    â””â”€â†’ bitbrowser_profiles (1å¯¹å¤š)

zones_zone (ä¸“åŒº)
    â”œâ”€â†’ zones_config (1å¯¹å¤š)
    â”œâ”€â†’ zones_user_access (å¤šå¯¹å¤š via users)
    â”œâ”€â†’ tasks (1å¯¹å¤š)
    â””â”€â†’ task_statistics (1å¯¹å¤š)

tasks (ä»»åŠ¡)
    â”œâ”€â†’ task_logs (1å¯¹å¤š)
    â”œâ”€â†’ card_usage_logs (1å¯¹å¤š)
    â”œâ”€â†’ sheerid_verifications (1å¯¹å¤š)
    â””â”€â†’ gemini_subscriptions (1å¯¹å¤š)

cards (è™šæ‹Ÿå¡)
    â”œâ”€â†’ card_usage_logs (1å¯¹å¤š)
    â”œâ”€â†’ google_accounts (1å¯¹å¤š)
    â””â”€â†’ gemini_subscriptions (1å¯¹å¤š)

orders (è®¢å•)
    â””â”€â†’ payments (1å¯¹å¤š)

payments (æ”¯ä»˜)
    â””â”€â†’ payment_logs (1å¯¹å¤š)

google_accounts (Googleè´¦å·)
    â”œâ”€â†’ sheerid_verifications (1å¯¹å¤š)
    â”œâ”€â†’ gemini_subscriptions (1å¯¹å¤š)
    â””â”€â†’ bitbrowser_profiles (1å¯¹å¤š)

proxies (ä»£ç†)
    â””â”€â†’ bitbrowser_profiles (1å¯¹å¤š)
```

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡

### å­˜å‚¨ä¼°ç®—

| è¡¨å | é¢„ä¼°è¡Œæ•° | å•è¡Œå¤§å° | é¢„ä¼°æ€»å¤§å° |
|------|----------|----------|------------|
| accounts_user | 1ä¸‡ | 1KB | 10MB |
| accounts_balance | 1ä¸‡ | 0.2KB | 2MB |
| accounts_balance_log | 100ä¸‡ | 0.3KB | 300MB |
| zones_zone | 10 | 1KB | 10KB |
| zones_config | 50 | 0.5KB | 25KB |
| zones_user_access | 5ä¸‡ | 0.2KB | 10MB |
| tasks | 100ä¸‡ | 2KB | 2GB |
| task_logs | 1000ä¸‡ | 0.5KB | 5GB |
| task_statistics | 1ä¸‡ | 0.3KB | 3MB |
| cards | 1000 | 0.5KB | 500KB |
| card_usage_logs | 50ä¸‡ | 0.4KB | 200MB |
| orders | 10ä¸‡ | 0.6KB | 60MB |
| payments | 10ä¸‡ | 0.5KB | 50MB |
| payment_logs | 50ä¸‡ | 0.4KB | 200MB |
| recharge_cards | 5ä¸‡ | 0.3KB | 15MB |
| payment_configs | 20 | 0.5KB | 10KB |
| user_api_keys | 1000 | 0.5KB | 500KB |
| proxies | 500 | 0.4KB | 200KB |
| google_accounts | 5000 | 0.6KB | 3MB |
| sheerid_verifications | 5000 | 0.5KB | 2.5MB |
| gemini_subscriptions | 5000 | 0.4KB | 2MB |
| bitbrowser_profiles | 5000 | 1KB | 5MB |

**æ€»è®¡é¢„ä¼°**: ~8GB (åŒ…å«ç´¢å¼•çº¦12-15GB)

---

## ğŸ”’ å®‰å…¨è®¾è®¡

### åŠ å¯†å­—æ®µ

ä»¥ä¸‹å­—æ®µåº”è¿›è¡ŒåŠ å¯†å­˜å‚¨ï¼š

1. **cards.card_number** - è™šæ‹Ÿå¡å·
2. **cards.cvv** - CVVå®‰å…¨ç 
3. **user_api_keys.api_key_encrypted** - APIå¯†é’¥
4. **google_accounts.password** - Googleè´¦å·å¯†ç 
5. **google_accounts.two_fa_secret** - 2FAå¯†é’¥
6. **proxies.password** - ä»£ç†å¯†ç 

**åŠ å¯†æ–¹æ³•**: ä½¿ç”¨ `cryptography.fernet` + Django `ENCRYPTION_KEY`

### è„±æ•å±•ç¤º

å¯¹å¤–å±•ç¤ºæ—¶åº”è„±æ•ï¼š

1. **å¡å·**: æ˜¾ç¤ºå4ä½ (****1234)
2. **APIkey**: æ˜¾ç¤ºå‰å4ä½ (abcd...xyz9)
3. **é‚®ç®±**: æ˜¾ç¤ºéƒ¨åˆ† (a***@gmail.com)
4. **æ‰‹æœº**: æ˜¾ç¤ºå‰3å4ä½ (138****5678)

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç´¢å¼•ä¼˜åŒ–

1. **é«˜é¢‘æŸ¥è¯¢å­—æ®µ**: å·²æ·»åŠ ç´¢å¼•
2. **ç»„åˆç´¢å¼•**: user_id + status, zone_id + status
3. **æ—¶é—´èŒƒå›´æŸ¥è¯¢**: created_at DESC
4. **JSONå­—æ®µ**: å¯è€ƒè™‘GINç´¢å¼• (å¦‚metadata)

### åˆ†åŒºç­–ç•¥

å»ºè®®å¯¹ä»¥ä¸‹è¡¨è¿›è¡Œåˆ†åŒºï¼š

1. **task_logs**: æŒ‰æœˆåˆ†åŒº (æ•°æ®é‡å¤§)
2. **accounts_balance_log**: æŒ‰æœˆåˆ†åŒº
3. **card_usage_logs**: æŒ‰æœˆåˆ†åŒº

### å½’æ¡£ç­–ç•¥

1. **task_logs**: ä¿ç•™3ä¸ªæœˆï¼Œå…¶ä½™å½’æ¡£
2. **payment_logs**: ä¿ç•™6ä¸ªæœˆ
3. **accounts_balance_log**: ä¿ç•™12ä¸ªæœˆ

---

## ğŸ“ å¤‡æ³¨

1. æ‰€æœ‰é‡‘é¢å­—æ®µä½¿ç”¨ **DECIMAL(10,2)** å­˜å‚¨ï¼Œå•ä½ä¸ºäººæ°‘å¸(å…ƒ)
2. æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ **TIMESTAMP WITH TIME ZONE**
3. JSONBå­—æ®µç”¨äºå­˜å‚¨çµæ´»çš„æ‰©å±•æ•°æ®
4. å¤–é”®åˆ é™¤ç­–ç•¥ï¼šCASCADE(çº§è”åˆ é™¤) æˆ– SET NULL(è®¾ä¸ºç©º)
5. æ‰€æœ‰è¡¨éƒ½æœ‰ **created_at** å’Œ **updated_at** æ—¶é—´æˆ³
6. æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨ï¼Œéœ€åœ¨åº”ç”¨å±‚è§£å¯†

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-16  
**æœ€åæ›´æ–°**: 2026-01-16  
**ç»´æŠ¤è€…**: Auto All System Team

